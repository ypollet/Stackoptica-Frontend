var gt=Object.defineProperty;var ht=(o,t,s)=>t in o?gt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var I=(o,t,s)=>ht(o,typeof t!="symbol"?t+"":t,s);import{d as _t}from"./vendor_vuedraggable-C3FdSLLj.js";import{d as g,c as M,a as i,u as e,o as p,b as D,e as y,w as r,r as k,m as z,n as N,g as G,f as V,h as b,i as vt,j as Z,v as yt,k as bt,l as xt,p as wt,q as P,t as K,s as oe,x as E,y as ee,z as Be,A as Pe,F as me,B as ge,C as kt,D as je,E as $t}from"./vendor_@vue-VPP15lpl.js";import{C as le,d as Me,R as Ct,t as Bt,c as Pt,x as q,N as Mt,j as St,I as H,H as Dt,K as Ue,L as zt,Q as Lt,e as Ot,a as It,b as Vt,z as jt,X as Et,Z as qt,U as Xe,J as Tt,f as Rt,S as Wt,_ as Ft,g as Se,h as At,i as Ht,O as Ut,k as Xt,l as Kt,p as Nt,m as Gt,s as Ee,q as Zt,n as Yt,o as Jt,Y as Qt,r as Ke,u as es,M as ts,v as ss,F as as,V as os,w as ls,y as ns,A as rs,B as is,D as ds,W as us,E as cs,G as fs,P as ps,T as ms,$ as gs,a0 as hs,a1 as _s,a2 as vs,a3 as ys,a4 as bs,a5 as xs,a6 as ws,a7 as ks,a8 as $s,a9 as qe,aa as Cs,ab as Bs,ac as Ps,ad as Ms,ae as Ss,af as Ds,ag as zs,ah as Ls}from"./vendor-DWQdnDYa.js";import{a as ye,m as Te,b as Re,d as ue,r as Os,s as be,n as de}from"./vendor_mathjs-CzgFTx2h.js";import"./index-BD57duzH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const n of d.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(l){if(l.ep)return;l.ep=!0;const d=s(l);fetch(l.href,d)}})();var io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uo(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function co(o){if(o.__esModule)return o;var t=o.default;if(typeof t=="function"){var s=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(a){var l=Object.getOwnPropertyDescriptor(o,a);Object.defineProperty(s,a,l.get?l:{enumerable:!0,get:function(){return o[a]}})}),s}class We{constructor(){I(this,"deque");this.deque=new Array}add(t){this.selected(t)||t==null||(this.deque.length==2&&this.deque.shift(),this.deque.push(t))}remove(t){let s=this.deque.indexOf(t);this.deque.splice(s,1)}selected(t){return this.deque.indexOf(t)>=0}fullSelected(){return this.deque.length==2}}class Fe{constructor(t,s,a){I(this,"label");I(this,"landmarkLeft");I(this,"landmarkRight");I(this,"edit_label");I(this,"edit_distance");console.log("Creation Distance : "+s.id+" "+a.id),this.label=t,this.landmarkLeft=s,this.landmarkRight=a,this.edit_label=!1,this.edit_distance=!1}get distance(){if(!(this.landmarkLeft.pose==null||this.landmarkRight.pose==null))return[ye(this.landmarkLeft.pose.marker.x-this.landmarkRight.pose.marker.x),ye(this.landmarkLeft.pose.marker.y-this.landmarkRight.pose.marker.y),ye(this.landmarkLeft.pose.image-this.landmarkRight.pose.image)]}in(t){return console.log(this.landmarkLeft.equals(t)||this.landmarkRight.equals(t)),this.landmarkLeft.equals(t)||this.landmarkRight.equals(t)}equals(t){return console.log("Equals DIstance"),console.log(this.landmarkLeft.equals(t.landmarkLeft)&&this.landmarkRight.equals(t.landmarkRight)),console.log(this.landmarkLeft.equals(t.landmarkRight)&&this.landmarkRight.equals(t.landmarkLeft)),this.landmarkLeft.equals(t.landmarkLeft)&&this.landmarkRight.equals(t.landmarkRight)||this.landmarkLeft.equals(t.landmarkRight)&&this.landmarkRight.equals(t.landmarkLeft)}}class De{constructor(t,s,a=null,l=void 0){I(this,"id");I(this,"label");I(this,"pose");I(this,"color");I(this,"edit");this.id=t,this.label=s,this.pose=l,this.edit=!1,a==null&&(a=le.rgb([Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)])),this.color=a}equals(t){return t==null?!1:typeof t=="string"?this.id==t:this.id==t.id}toJSON(){return{id:this.id,label:this.label,color:this.color.hex(),pose:this.pose}}getId(){return this.id}getLabel(){return this.label}setLabel(t){this.label=t}getColorHEX(){return this.color.hex()}setColorHEX(t){this.color=le(t)}setColorRGB(t){t.length<3||(this.color=le.rgb(t[0],t[1],t[2]))}setPose(t,s){this.pose={marker:s,image:t}}removePose(){this.pose=void 0}getPose(){return this.pose}getEdit(){return this.edit}setEdit(t){this.edit=t}}const Ne=Me("settings",{state:()=>({isLeft:!1}),actions:{useToggleLeft(o){this.isLeft=o}},persist:{storage:localStorage,key:"settings"}}),Y=Me("image",{state:()=>({objectPath:"",index:0,images:Array(),size:{width:-1,height:-1},voxel:[1,1,1],zoom:-1,offset:{x:0,y:0}}),getters:{selectedImage:o=>o.index>=0&&o.index<o.images.length?o.images[o.index]:{name:"RBINS Logo",image:"https://www.naturalsciences.be/bundles/8c62adb1e0fbef009ef7c06c69a991890012e203/img/logos/logo.svg"}},actions:{setPath(o){this.reset(),this.objectPath=o},reset(){this.objectPath="",this.index=0,this.images=Array(),this.size={width:-1,height:-1},this.voxel=[1,1,1],this.zoom=-1,this.offset={x:0,y:0}},setIndex(o){this.index=Te(Re(0,o),this.images.length-1)},moveIndex(o){this.index=Te(Re(0,this.index+o),this.images.length-1)},increment(){this.moveIndex(1)},decrement(){this.moveIndex(-1)}},persist:{storage:sessionStorage,key:"image",afterHydrate:o=>{console.log("Restore Images Store"),console.log(o.store.$state)}}}),ie=Me("landmarks",{state:()=>({landmarks:Array(),selectedGroup:new We,distances:Array(),adjustFactor:1,scale:"m"}),actions:{addLandmark(o){this.landmarks.push(o)},generateID(){let o=!1,t="";for(;!o;)t=(Math.random()+1).toString(36).substring(2),this.landmarks.filter(s=>s.getId()===t).length==0&&(o=!0);return t},addDistance(o,t,s=null){let a=new Fe(s||"distance_"+this.distances.length,o,t);this.distances.filter(l=>l.equals(a)).length==0&&this.distances.push(a)}},persist:{storage:sessionStorage,key:"landmarks",afterHydrate:o=>{let s=o.store.$state.landmarks.map(n=>n).map(n=>new De(n.id,n.label,le(n.color),n.pose));o.store.$state.landmarks=s;let a=new We,l=o.store.$state.selectedGroup;if(l){for(let n=0;n<Object.values(l.deque).length;n++)a.add(l.deque[n]);o.store.$state.selectedGroup=a}let d=o.store.$state.distances.map(n=>n);o.store.$state.distances=d.map(n=>new Fe(n.label,s[s.map(u=>u.id).indexOf(n.landmarkLeft.id)],s[s.map(u=>u.id).indexOf(n.landmarkRight.id)]))}}}),Is={class:"overflow-hidden"},Vs=g({__name:"App",setup(o){const t=Y();console.log("WEB");function s(a){let l=a.key;l=="ArrowUp"&&t.increment(),l=="ArrowDown"&&t.decrement()}return(a,l)=>(p(),M("div",Is,[i(e(Ct),{onKeydown:s})]))}});function w(...o){return Bt(Pt(o))}var ne=(o=>(o[o.m=1]="m",o[o.dm=.1]="dm",o[o.cm=.01]="cm",o[o.mm=.001]="mm",o[o.µm=1e-6]="µm",o[o.nm=1e-9]="nm",o))(ne||{});const js=.1,Es=4,Q=4.5,W=.2,qs=g({__name:"Menubar",props:{modelValue:{},defaultValue:{},dir:{},loop:{type:Boolean},class:{}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(Mt),z(e(d),{class:e(w)("flex h-10 items-center gap-x-1 rounded-md border bg-background p-1",s.class)}),{default:r(()=>[k(n.$slots,"default")]),_:3},16,["class"]))}}),ae=g({__name:"MenubarItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},emits:["select"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(St),z(e(d),{class:e(w)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n.inset&&"pl-8",s.class)}),{default:r(()=>[k(n.$slots,"default")]),_:3},16,["class"]))}}),xe=g({__name:"MenubarContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:8},align:{default:"start"},alignOffset:{default:-4},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(Ue),null,{default:r(()=>[i(e(Dt),z(e(a),{class:e(w)("z-50 min-w-48 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t.class)}),{default:r(()=>[k(l.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),we=g({__name:"MenubarMenu",props:{value:{}},setup(o){const t=o;return(s,a)=>(p(),y(e(zt),N(G(t)),{default:r(()=>[k(s.$slots,"default")]),_:3},16))}}),Ts=g({__name:"MenubarSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=q(o,t);return(d,n)=>(p(),y(e(Lt),N(G(e(l))),{default:r(()=>[k(d.$slots,"default")]),_:3},16))}}),Rs=g({__name:"MenubarSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(Ue),null,{default:r(()=>[i(e(Ot),z(e(d),{class:e(w)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s.class)}),{default:r(()=>[k(n.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Ws=g({__name:"MenubarSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(Vt),z(e(a),{class:e(w)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",l.inset&&"pl-8",t.class)}),{default:r(()=>[k(l.$slots,"default"),i(e(It),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),ke=g({__name:"MenubarTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(jt),z(e(a),{class:e(w)("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t.class)}),{default:r(()=>[k(l.$slots,"default")]),_:3},16,["class"]))}}),Ae=g({__name:"MenubarShortcut",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),M("span",{class:V(e(w)("ml-auto text-xs tracking-widest text-muted-foreground",t.class))},[k(s.$slots,"default")],2))}}),$e=g({__name:"MenubarLabel",props:{asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(o){const t=o;return(s,a)=>(p(),y(e(Et),{class:V(e(w)("px-2 py-1.5 text-sm font-semibold",s.inset&&"pl-8",t.class))},{default:r(()=>[k(s.$slots,"default")]),_:3},8,["class"]))}}),Fs=g({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=q(o,t);return(d,n)=>(p(),y(e(qt),N(G(e(l))),{default:r(()=>[k(d.$slots,"default")]),_:3},16))}}),As=g({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(o){const t=o;return(s,a)=>(p(),y(e(Xe),N(G(t)),{default:r(()=>[k(s.$slots,"default")]),_:3},16))}}),Hs=g({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(o){const t=o;return(s,a)=>(p(),y(e(Tt),N(G(t)),{default:r(()=>[k(s.$slots,"default")]),_:3},16))}}),Us=g({__name:"DialogHeader",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),M("div",{class:V(e(w)("flex flex-col gap-y-1.5 text-center sm:text-left",t.class))},[k(s.$slots,"default")],2))}}),Xs=g({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(Rt),z(e(a),{class:e(w)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:r(()=>[k(l.$slots,"default")]),_:3},16,["class"]))}}),Ks=g({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(Wt),z(e(a),{class:e(w)("text-sm text-muted-foreground",t.class)}),{default:r(()=>[k(l.$slots,"default")]),_:3},16,["class"]))}}),Ns=g({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(Ht),null,{default:r(()=>[i(e(Ft),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),i(e(At),z(e(d),{class:e(w)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s.class)}),{default:r(()=>[k(n.$slots,"default"),i(e(Xe),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:r(()=>[i(e(Se),{class:"w-4 h-4"}),u[0]||(u[0]=b("span",{class:"sr-only"},"Close",-1))]),_:1})]),_:3},16,["class"])]),_:3}))}}),Gs=g({__name:"DialogFooter",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),M("div",{class:V(e(w)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",t.class))},[k(s.$slots,"default")],2))}}),fe=g({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,l=vt(s,"modelValue",t,{passive:!0,defaultValue:s.defaultValue});return(d,n)=>Z((p(),M("input",{"onUpdate:modelValue":n[0]||(n[0]=u=>bt(l)?l.value=u:null),class:V(e(w)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s.class))},null,2)),[[yt,e(l)]])}}),re=g({__name:"Button",props:{variant:{},size:{},as:{default:"button"},class:{},asChild:{type:Boolean}},setup(o){const t=o;return(s,a)=>(p(),y(e(Ut),{as:s.as,"as-child":s.asChild,class:V(e(w)(e(Zs)({variant:s.variant,size:s.size}),t.class))},{default:r(()=>[k(s.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),Zs=Xt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=g({__name:"Label",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:a,...l}=t;return l});return(a,l)=>(p(),y(e(Kt),z(s.value,{class:e(w)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t.class)}),{default:r(()=>[k(a.$slots,"default")]),_:3},16,["class"]))}}),He=g({__name:"Switch",props:{defaultChecked:{type:Boolean},checked:{type:Boolean},disabled:{type:Boolean},required:{type:Boolean},name:{},id:{},value:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:checked"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(Gt),z(e(d),{class:e(w)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s.class)}),{default:r(()=>[i(e(Nt),{class:V(e(w)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"))},null,8,["class"])]),_:1},16,["class"]))}}),Ys={class:"flex flex-row justify-between h-full w-full"},Js={class:"flex flex-row justify-between h-full w-full"},Qs=g({__name:"Menu",setup(o){const t=Ne(),s=ie(),a=Y(),l=xt({storageKey:"localStorage"}),d=wt(l);function n(){const _=[["Label","Color","Pose_X","Pose_Y","Image","X","Y","Z"]];s.landmarks.filter(x=>x.pose!=null).forEach(x=>{x=x;let S=x.pose,U=ue(a.voxel,[S.marker.x,S.marker.y,S.image]),X=[x.label,x.getColorHEX(),S.marker.x.toString(),S.marker.y.toString(),a.images[S.image].name,U[0].toString(),U[1].toString(),U[2].toString()];_.push(X)});let f=_.map(x=>x.join(";")).join(`
`),v=new Blob([f],{type:"text/csv;charset=utf-8;"});Ee(v,"landmarks_"+a.objectPath+".csv")}function u(){const _=new Map;_.set("scale_factor",s.adjustFactor);let f=new Map;s.landmarks.forEach(S=>{f.set(S.id,{label:S.label,color:S.getColorHEX(),pose:S.pose})}),_.set("landmarks",Object.fromEntries(f));let v=new Array;s.distances.forEach(S=>{v.push({label:S.label,left:S.landmarkLeft.id,right:S.landmarkRight.id})}),_.set("distances",v);var x=new Blob([JSON.stringify(Object.fromEntries(_.entries()))],{type:"application/json;charset=utf-8"});Ee(x,"landmarks_"+a.objectPath+"_"+new Date().getTime()+".json")}function h(_){_.preventDefault();let x=_.target.elements[0].files[0];x&&x.text().then(S=>{C(S)}).catch(S=>{console.error(S)})}function C(_){let f=JSON.parse(_),v=new Map(Object.entries(f));console.log(v);let x=new Map;new Map(Object.entries(v.get("landmarks"))).forEach((U,X)=>{let T=new Map(Object.entries(U)),j=new De(s.generateID(),T.get("label"),le(T.get("color")),T.get("pose"));x.set(X,j),s.addLandmark(j)}),v.get("distances")&&v.get("distances").forEach(U=>{let X=new Map(Object.entries(U));s.addDistance(x.get(X.get("left")),x.get(X.get("right")),X.get("label"))})}return(_,f)=>(p(),M("div",null,[i(e(Fs),null,{default:r(()=>[i(e(qs),{class:"rounded border-b z-100 h-10"},{default:r(()=>[i(e(we),null,{default:r(()=>[i(e(ke),{class:"relative"},{default:r(()=>f[0]||(f[0]=[P(" File ")])),_:1}),i(e(xe),null,{default:r(()=>[i(e($e),null,{default:r(()=>f[1]||(f[1]=[P(" Landmarks ")])),_:1}),i(e(Hs),{asChild:""},{default:r(()=>[i(e(ae),{inset:""},{default:r(()=>f[2]||(f[2]=[P("Import")])),_:1})]),_:1}),i(e(Ts),null,{default:r(()=>[i(e(Ws),{inset:""},{default:r(()=>f[3]||(f[3]=[P("Export")])),_:1}),i(e(Rs),null,{default:r(()=>[i(e(ae),{onSelect:n},{default:r(()=>f[4]||(f[4]=[P(" CSV ")])),_:1}),i(e(ae),{onSelect:u},{default:r(()=>f[5]||(f[5]=[P(" JSON ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(e(we),null,{default:r(()=>[i(e(ke),null,{default:r(()=>f[6]||(f[6]=[P("Edit")])),_:1}),i(e(xe),null,{default:r(()=>[i(e(ae),{disabled:""},{default:r(()=>[f[8]||(f[8]=P(" Undo ")),i(e(Ae),null,{default:r(()=>f[7]||(f[7]=[P("⌘Z")])),_:1})]),_:1}),i(e(ae),{disabled:""},{default:r(()=>[f[10]||(f[10]=P(" Redo ")),i(e(Ae),null,{default:r(()=>f[9]||(f[9]=[P("⇧⌘Z")])),_:1})]),_:1})]),_:1})]),_:1}),i(e(we),null,{default:r(()=>[i(e(ke),null,{default:r(()=>f[11]||(f[11]=[P(" Settings ")])),_:1}),i(e(xe),null,{default:r(()=>[i(e($e),{inset:""},{default:r(()=>[b("div",Ys,[f[12]||(f[12]=b("span",null,"Dark Mode :",-1)),i(e(He),{checked:e(l),"onUpdate:checked":e(d),class:"inline-block align-middle ml-auto"},null,8,["checked","onUpdate:checked"])])]),_:1}),i(e($e),{inset:""},{default:r(()=>[b("div",Js,[f[13]||(f[13]=b("span",null,"Reverse Mode :",-1)),i(e(He),{checked:e(t).isLeft,"onUpdate:checked":e(t).useToggleLeft,class:"inline-block align-middle self-end"},null,8,["checked","onUpdate:checked"])])]),_:1})]),_:1})]),_:1})]),_:1}),i(e(Ns),null,{default:r(()=>[i(e(Us),null,{default:r(()=>[i(e(Xs),null,{default:r(()=>f[14]||(f[14]=[P("Add the landmark file")])),_:1}),i(e(Ks),null,{default:r(()=>f[15]||(f[15]=[P("Add the json files containing the landmarks")])),_:1})]),_:1}),b("form",{onSubmit:h},[i(e(pe),null,{default:r(()=>f[16]||(f[16]=[P("File")])),_:1}),i(e(fe),{type:"file",placeholder:"your landmark json file"}),i(e(Gs),null,{default:r(()=>[i(e(As),{"as-child":""},{default:r(()=>[i(e(re),{type:"submit"},{default:r(()=>f[17]||(f[17]=[P("Confirm")])),_:1})]),_:1})]),_:1})],32)]),_:1})]),_:1})]))}}),Ge=g({__name:"Separator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{},label:{}},setup(o){const t=o,s=D(()=>{const{class:a,...l}=t;return l});return(a,l)=>(p(),y(e(Zt),z(s.value,{class:e(w)("shrink-0 bg-border relative",t.orientation==="vertical"?"w-px h-full":"h-px w-full",t.class)}),{default:r(()=>[t.label?(p(),M("span",{key:0,class:V(e(w)("text-xs text-muted-foreground bg-background absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex justify-center items-center",t.orientation==="vertical"?"w-[1px] px-1 py-2":"h-[1px] py-1 px-2"))},K(t.label),3)):oe("",!0)]),_:1},16,["class"]))}}),ea=["onDblclick"],ta={class:"h-12 flex grow row justify-between items-center font-normal space-x-3 px-3 py-2"},sa={class:"flex items-center justify-start space-x-3 py-3"},aa={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-6 w-6 handle"},oa=["value","onChange"],la={class:"flex items-center justify-end space-x-4"},na=g({__name:"LandmarkList",setup(o){const t=ie(),s=E(!0),a=E(null),l=E(null);function d(_,f){let v=_.currentTarget;v!=null&&t.landmarks.find(x=>x.getId()==f).setColorHEX(v.value)}function n(_,f){f.setLabel(_.toString())}function u(_){t.distances=t.distances.filter(f=>!f.in(_)),t.landmarks=t.landmarks.filter(f=>!f.equals(_))}function h(_){t.selectedGroup.selected(_)?t.selectedGroup.remove(_):t.selectedGroup.add(_)}function C(_){t.selectedGroup.fullSelected()||_.preventDefault()}return(_,f)=>(p(),M("div",{ref_key:"landmarksScroll",ref:l,class:V(["overflow-auto min-h-16 max-h-96 w-full border",{"scroll-snap-type":s.value}])},[i(e(_t),{ref_key:"landmarksElements",ref:a,modelValue:e(t).landmarks,"onUpdate:modelValue":f[3]||(f[3]=v=>e(t).landmarks=v),group:"landmarks","item-key":"id","force-fallback":!0,animation:150,scroll:!0,bubbleScroll:!0,handle:".handle",class:"relative w-fit min-w-full",onStart:f[4]||(f[4]=v=>s.value=!1),onEnd:f[5]||(f[5]=v=>s.value=!0),onContextmenu:C},{item:r(({element:v})=>[b("div",{class:V(["scroll-align border flex grow p-2",{"dark:bg-purple-800 bg-purple-400":e(t).selectedGroup.selected(v.id)}]),onDblclick:x=>h(v.id)},[b("div",ta,[b("div",sa,[(p(),M("svg",aa,[b("path",{d:"M7.49985 0.877045C3.84216 0.877045 0.877014 3.84219 0.877014 7.49988C0.877014 11.1575 3.84216 14.1227 7.49985 14.1227C11.1575 14.1227 14.1227 11.1575 14.1227 7.49988C14.1227 3.84219 11.1575 0.877045 7.49985 0.877045ZM1.82701 7.49988C1.82701 4.36686 4.36683 1.82704 7.49985 1.82704C10.6328 1.82704 13.1727 4.36686 13.1727 7.49988C13.1727 10.6329 10.6328 13.1727 7.49985 13.1727C4.36683 13.1727 1.82701 10.6329 1.82701 7.49988ZM7.49999 9.49999C8.60456 9.49999 9.49999 8.60456 9.49999 7.49999C9.49999 6.39542 8.60456 5.49999 7.49999 5.49999C6.39542 5.49999 5.49999 6.39542 5.49999 7.49999C5.49999 8.60456 6.39542 9.49999 7.49999 9.49999Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd",onDragenter:f[0]||(f[0]=x=>console.log("Enter")),onDragleave:f[1]||(f[1]=x=>console.log("leave"))},null,32)])),b("input",{type:"color",class:"h-8 w-8 block bg-white border border-gray-950 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-300",id:"hs-color-input",value:v.getColorHEX(),title:"Choose your color",onChange:x=>d(x,v.getId())},null,40,oa),Z(i(e(pe),{class:"whitespace-nowrap",onDblclick:Be(x=>v.setEdit(!0),["stop"])},{default:r(()=>[P(K(v.label),1)]),_:2},1032,["onDblclick"]),[[ee,!v.getEdit()]]),Z(i(e(fe),{onDblclick:f[2]||(f[2]=Be(()=>{},["stop"])),type:"text","model-value":v.label,class:"h-auto",onFocusout:x=>v.setEdit(!1),onKeyup:Pe(x=>v.setEdit(!1),["enter"]),"onUpdate:modelValue":x=>n(x,v)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[ee,v.getEdit()]])]),b("div",la,[i(e(re),{class:"relative w-6 h-6 p-0",variant:"secondary",onClick:x=>v.removePose()},{default:r(()=>[i(e(Yt),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"]),i(e(re),{class:"relative w-6 h-6 p-0",variant:"destructive",onClick:x=>u(v.getId())},{default:r(()=>[i(e(Se),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"])])])],42,ea)]),_:1},8,["modelValue"])],2))}}),ra={class:"flex min-h-48 max-w-full flex flex-col border"},ia={class:"flex flex-col w-full h-10"},da={class:"flex row items-center justify-start space-x-3 px-3 w-full h-full"},ua=.01,ca=g({__name:"DistanceList",setup(o){const t=ie(),s=Y();function a(d,n){n.label=d.toString(),console.log(n)}function l(d,n){console.log(n.distance),t.adjustFactor=de(d)/be(ue(s.voxel,n.distance))*de(ne[t.scale]),console.log(t.adjustFactor)}return(d,n)=>(p(),M("div",ra,[(p(!0),M(me,null,ge(e(t).distances,(u,h)=>(p(),M("div",ia,[b("div",da,[Z(i(e(pe),{class:"flex whitespace-nowrap w-36",onDblclick:C=>u.edit_label=!0},{default:r(()=>[P(K(u.label),1)]),_:2},1032,["onDblclick"]),[[ee,!u.edit_label]]),Z(i(e(fe),{type:"text","model-value":u.label,class:"flex h-auto w-36 px-0",onFocusout:C=>u.edit_label=!1,onKeyup:Pe(C=>u.edit_label=!1,["enter"]),"onUpdate:modelValue":C=>a(C,u)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[ee,u.edit_label]]),n[0]||(n[0]=b("span",null,":",-1)),Z(i(e(pe),{class:"flex whitespace-nowrap w-36",onDblclick:C=>u.edit_distance=!0},{default:r(()=>[P(K(Os(u.distance?be(ue(e(s).voxel,u.distance))*e(t).adjustFactor/de(e(ne)[e(t).scale]):0,5))+" "+K(e(t).scale),1)]),_:2},1032,["onDblclick"]),[[ee,!u.edit_distance]]),Z(i(e(fe),{type:"number",min:0,step:ua,"model-value":u.distance?be(ue(e(s).voxel,u.distance))*e(t).adjustFactor/de(e(ne)[e(t).scale]):0,class:"flex h-auto w-36 px-0",onFocusout:C=>u.edit_distance=!1,onKeyup:Pe(C=>u.edit_distance=!1,["enter"]),"onUpdate:modelValue":C=>l(C,u)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[ee,u.edit_distance]]),i(e(re),{class:"relative w-6 h-6 p-0",variant:"destructive",onClick:C=>e(t).distances.splice(h,1)},{default:r(()=>[i(e(Se),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"])]),i(e(Ge),{class:"w-full"})]))),256))]))}}),fa=g({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},dir:{},name:{},autocomplete:{},disabled:{type:Boolean},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(o,{emit:t}){const l=q(o,t);return(d,n)=>(p(),y(e(Jt),N(G(e(l))),{default:r(()=>[k(d.$slots,"default")]),_:3},16))}}),pa=g({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(o){const t=o;return(s,a)=>(p(),y(e(Qt),N(G(t)),{default:r(()=>[k(s.$slots,"default")]),_:3},16))}}),ma=g({__name:"SelectTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(ts),z(e(a),{class:e(w)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t.class)}),{default:r(()=>[k(l.$slots,"default"),i(e(es),{"as-child":""},{default:r(()=>[i(e(Ke),{class:"w-4 h-4 opacity-50"})]),_:1})]),_:3},16,["class"]))}}),ga=g({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(os),null,{default:r(()=>[i(e(as),z({...e(d),...n.$attrs},{class:e(w)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s.class)}),{default:r(()=>[i(e(ba)),i(e(ss),{class:V(e(w)("p-1",n.position==="popper"&&"h-[--radix-select-trigger-height] w-full min-w-[--radix-select-trigger-width]"))},{default:r(()=>[k(n.$slots,"default")]),_:3},8,["class"]),i(e(xa))]),_:3},16,["class"])]),_:3}))}}),ha=g({__name:"SelectGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:a,...l}=t;return l});return(a,l)=>(p(),y(e(ls),z({class:e(w)("p-1 w-full",t.class)},s.value),{default:r(()=>[k(a.$slots,"default")]),_:3},16,["class"]))}}),_a={class:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},va=g({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(ds),z(e(a),{class:e(w)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t.class)}),{default:r(()=>[b("span",_a,[i(e(rs),null,{default:r(()=>[i(e(ns),{class:"h-4 w-4"})]),_:1})]),i(e(is),null,{default:r(()=>[k(l.$slots,"default")]),_:3})]),_:3},16,["class"]))}}),ya=g({__name:"SelectLabel",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o;return(s,a)=>(p(),y(e(us),{class:V(e(w)("py-1.5 pl-8 pr-2 text-sm font-semibold",t.class))},{default:r(()=>[k(s.$slots,"default")]),_:3},8,["class"]))}}),ba=g({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(fs),z(e(a),{class:e(w)("flex cursor-default items-center justify-center py-1",t.class)}),{default:r(()=>[k(l.$slots,"default",{},()=>[i(e(cs),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),xa=g({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:l,...d}=t;return d}),a=H(s);return(l,d)=>(p(),y(e(ps),z(e(a),{class:e(w)("flex cursor-default items-center justify-center py-1",t.class)}),{default:r(()=>[k(l.$slots,"default",{},()=>[i(e(Ke),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),wa=g({__name:"Slider",props:{name:{},defaultValue:{},modelValue:{},disabled:{type:Boolean},orientation:{},dir:{},inverted:{type:Boolean},min:{},max:{},step:{},minStepsBetweenThumbs:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","valueCommit"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(_s),z({class:e(w)("relative flex w-full touch-none select-none items-center",s.class)},e(d)),{default:r(()=>[i(e(gs),{class:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary"},{default:r(()=>[i(e(ms),{class:"absolute h-full bg-primary"})]),_:1}),(p(!0),M(me,null,ge(n.modelValue,(h,C)=>(p(),y(e(hs),{key:C,class:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}))),128))]),_:1},16,["class"]))}}),Ze=g({__name:"ContextMenu",props:{dir:{},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=q(o,t);return(d,n)=>(p(),y(e(vs),N(G(e(l))),{default:r(()=>[k(d.$slots,"default")]),_:3},16))}}),Ye=g({__name:"ContextMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(o){const s=H(o);return(a,l)=>(p(),y(e(ys),N(G(e(s))),{default:r(()=>[k(a.$slots,"default")]),_:3},16))}}),Je=g({__name:"ContextMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},sticky:{},hideWhenDetached:{type:Boolean},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(xs),null,{default:r(()=>[i(e(bs),z(e(d),{class:e(w)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s.class)}),{default:r(()=>[k(n.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),ce=g({__name:"ContextMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},emits:["select"],setup(o,{emit:t}){const s=o,a=t,l=D(()=>{const{class:n,...u}=s;return u}),d=q(l,a);return(n,u)=>(p(),y(e(ws),z(e(d),{class:e(w)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n.inset&&"pl-8",s.class)}),{default:r(()=>[k(n.$slots,"default")]),_:3},16,["class"]))}}),Ce=g({__name:"ContextMenuSeparator",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=D(()=>{const{class:a,...l}=t;return l});return(a,l)=>(p(),y(e(ks),z(s.value,{class:e(w)("-mx-1 my-1 h-px bg-border",t.class)}),null,16,["class"]))}}),ka=g({__name:"ContextMenuLabel",props:{asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(o){const t=o,s=D(()=>{const{class:a,...l}=t;return l});return(a,l)=>(p(),y(e($s),z(s.value,{class:e(w)("px-2 py-1.5 text-sm font-semibold text-foreground",a.inset&&"pl-8",t.class)}),{default:r(()=>[k(a.$slots,"default")]),_:3},16,["class"]))}}),$a={class:"pb-[12px] w-auto"},Ca={class:"space-y-4 py-4"},Ba={class:"px-3 py-2"},Pa={class:"px-3 py-2"},Ma={class:"px-3 py-2"},Sa={class:"flex row"},Da={class:"w-full h-full flex justify-end space-x-2"},za=g({__name:"Sidebar",setup(o){const t=Y(),s=ie();function a(){let d=s.selectedGroup.deque[0],n=s.selectedGroup.deque[1],u=s.landmarks.find(C=>C.id==d),h=s.landmarks.find(C=>C.id==n);s.addDistance(u,h)}function l(){s.adjustFactor=1}return console.log("Scale "+s.scale),(d,n)=>(p(),M("div",$a,[b("div",Ca,[b("div",Ba,[i(e(wa),{"model-value":[e(t).index],max:e(t).images.length-1,step:1,"onUpdate:modelValue":n[0]||(n[0]=u=>e(t).setIndex(u[0]))},null,8,["model-value","max"])]),b("div",Pa,[n[3]||(n[3]=b("h2",{class:"relative px-7 text-lg font-semibold tracking-tight"}," Landmarks ",-1)),i(e(Ze),null,{default:r(()=>[i(e(Ye),{class:"flex w-full h-full"},{default:r(()=>[i(e(na))]),_:1}),i(e(Je),{class:"w-64"},{default:r(()=>[i(e(ce),{class:"block",inset:"",onSelect:a},{default:r(()=>n[2]||(n[2]=[P(" Create Distance ")])),_:1})]),_:1})]),_:1})]),b("div",Ma,[b("div",Sa,[n[6]||(n[6]=b("h2",{class:"relative px-7 text-lg font-semibold tracking-tight"}," Distances ",-1)),b("div",Da,[i(e(fa),{modelValue:e(s).scale,"onUpdate:modelValue":n[1]||(n[1]=u=>e(s).scale=u)},{default:r(()=>[i(e(ma),{class:"w-16"},{default:r(()=>[i(e(pa),{placeholder:"Pick a scale"})]),_:1}),i(e(ga),null,{default:r(()=>[i(e(ha),null,{default:r(()=>[i(e(ya),null,{default:r(()=>n[4]||(n[4]=[P("Scale")])),_:1}),(p(!0),M(me,null,ge(Object.keys(e(ne)).filter(u=>isNaN(Number(u))),u=>(p(),y(e(va),{value:u},{default:r(()=>[P(K(u),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(e(re),{variant:"secondary",onClick:l},{default:r(()=>n[5]||(n[5]=[P(" Reset Scale ")])),_:1})])]),i(e(ca))])])]))}});class La{constructor(t){I(this,"provider");this.provider=t}async getImages(t){return console.log("get Images"),this.provider.getImages(t).then(s=>s.data.result)}async getImage(t,s){return this.provider.getImage(t,s).then(a=>a.data)}}class Oa{constructor(t){I(this,"server");this.server=t}async getImages(t){const s=this.server+"/"+t+"/images";return qe.get(s)}async getImage(t,s){const a=this.server+"/"+t+"/"+s;return qe.get(a)}}const Qe={type:"WEB",url:"http://localhost:5000"},et={type:"DATA"};class tt{static get(t){return this._instances.get(t)==null&&t=="WEB"?new Oa(Qe.url):this._instances.get(t)}}I(tt,"_instances",new Map);class ze{static get(t){return this._instances.get(t)==null&&t=="DATA"?new La(tt.get(Qe.type)):this._instances.get(t)}}I(ze,"_instances",new Map);const Ia={class:"flex space-x-2 items-center"},Va=["fill"],ja={class:"flex item-centers"},Ea={class:"flex space-x-4 items-center"},qa={class:"flex space-x-2 inline-block items-center"},Ta=["fill"],Ra={class:"inline-flex items-center align-middle"},Wa=["src","alt"],Fa=g({__name:"ImageViewer",props:{class:{}},setup(o){const t=ze.get(et.type),s=ie(),a=Y();s.$subscribe((m,c)=>{j()});const l=o;a.$subscribe((m,c)=>{j()});const d=E(null),n=E(null),u=E(null),h=E({x:0,y:0}),C=E(!1),_=E(null),f=E({x:-1,y:-1}),v=E({x:-1,y:-1}),x=E(!1),S=m=>m*Math.PI/180;kt(()=>{console.log("Mounted");const m=new ResizeObserver(function(){d.value&&u.value&&n.value&&(u.value.width=Math.floor(d.value.clientWidth),u.value.height=Math.floor(d.value.clientHeight),j())});d.value&&m.observe(d.value)});function U(){je(()=>{if(a.zoom<=0&&at(),n.value.alt.startsWith("Thumbnail")){let m=a.selectedImage.name;setTimeout(()=>{m==a.selectedImage.name&&t.getImage(a.objectPath,a.selectedImage.name).then(c=>{je(()=>{n.value.alt.endsWith(c.name)&&(n.value.src=c.image,n.value.alt=c.name,j())})})},500)}j()})}function X(){if(u.value&&n.value&&n.value.complete&&a.zoom>0){let m=ot(),c=u.value.getContext("2d"),B=a.zoom/m.ratioW,L=a.zoom/m.ratioH;c.scale(B,L),c.translate(a.offset.x*m.ratioW,a.offset.y*m.ratioH),h.value={x:Math.max(0,(u.value.width-n.value.naturalWidth*B)/2)/B,y:Math.max(0,(u.value.height-n.value.naturalHeight*L)/2)/L},c.drawImage(n.value,0,0,n.value.naturalWidth,n.value.naturalHeight,h.value.x,h.value.y,n.value.naturalWidth,n.value.naturalHeight),s.landmarks.forEach((R,Ve)=>{let J=R.getPose(),se=Q/a.zoom;if(!(!J&&!R.equals(_.value))){if(c.beginPath(),R.equals(_.value)){let $=f.value;$={x:$.x*m.ratioW,y:$.y*m.ratioH};const O=se*4*m.ratioW;c.arc($.x+h.value.x,$.y+h.value.y,O,0,2*Math.PI),c.strokeStyle="white",c.lineWidth=Q/2/B,c.stroke(),c.closePath(),c.beginPath();let F=T($,45,O,h.value),A=T($,45,O*W,h.value);c.moveTo(F.x,F.y),c.lineTo(A.x,A.y),F=T($,135,O,h.value),A=T($,135,O*W,h.value),c.moveTo(F.x,F.y),c.lineTo(A.x,A.y),F=T($,225,O,h.value),A=T($,225,O*W,h.value),c.moveTo(F.x,F.y),c.lineTo(A.x,A.y),F=T($,315,O,h.value),A=T($,315,O*W,h.value),c.moveTo(F.x,F.y),c.lineTo(A.x,A.y),c.strokeStyle="white",c.lineWidth=Q/3/B,c.stroke(),c.closePath(),c.beginPath(),c.moveTo($.x+h.value.x+O*(1-W),$.y+h.value.y),c.lineTo($.x+h.value.x+O*W,$.y+h.value.y),c.moveTo($.x+h.value.x-O*(1-W),$.y+h.value.y),c.lineTo($.x+h.value.x-O*W,$.y+h.value.y),c.moveTo($.x+h.value.x,$.y+h.value.y+O*(1-W)),c.lineTo($.x+h.value.x,$.y+h.value.y+O*W),c.moveTo($.x+h.value.x,$.y+h.value.y-O*(1-W)),c.lineTo($.x+h.value.x,$.y+h.value.y-O*W),c.strokeStyle="black",c.lineWidth=Q/3/B,c.stroke()}else{let $={x:J.marker.x*m.ratioW,y:J.marker.y*m.ratioH};c.arc($.x+h.value.x,$.y+h.value.y,se*m.ratioW,0,2*Math.PI),c.fillStyle=R.getColorHEX(),c.fill(),c.lineWidth=se/2*m.ratioW,c.strokeStyle=J.image==a.index?"black":"white",c.stroke()}c.closePath()}})}}function T(m,c,B,L={x:0,y:0}){return{x:m.x+B*Math.cos(S(c))+L.x,y:m.y+B*Math.sin(S(c))+L.y}}function j(){u.value&&n.value&&n.value.complete&&(u.value.width=u.value.width,_e(0,0),X())}function at(){d.value&&u.value&&(u.value.width=Math.floor(d.value.clientWidth),u.value.height=Math.floor(d.value.clientHeight),a.zoom=Math.min(d.value.clientWidth/a.size.width,d.value.clientHeight/a.size.height))}function ot(){return n.value&&n.value.complete?{ratioW:n.value.naturalWidth/a.size.width,ratioH:n.value.naturalHeight/a.size.height}:{ratioW:0,ratioH:0}}function te(m){const c=u.value.getBoundingClientRect();let B=(m.pageX-c.left)/a.zoom-a.offset.x-h.value.x,L=(m.pageY-c.top)/a.zoom-a.offset.y-h.value.y;return{x:B,y:L}}function _e(m,c){u.value&&(a.offset.x=a.offset.x+m/a.zoom,a.offset.y=a.offset.y+c/a.zoom,a.offset.x=Math.min(0,Math.max(-(a.size.width*a.zoom-u.value.width)/a.zoom,a.offset.x)),a.offset.y=Math.min(0,Math.max(-(a.size.height*a.zoom-u.value.height)/a.zoom,a.offset.y)))}function lt(m){a.zoom=+(a.zoom*(1+m/20)).toFixed(2),a.zoom=Math.max(js,Math.min(Es,a.zoom))}function nt(m){let c=a.zoom;lt(Math.sign(-m.deltaY));let B=a.zoom/c;const L=u.value.getBoundingClientRect();let R=m.pageX-L.left,Ve=m.pageY-L.top,J=-(L.width*B-L.width)*(R/L.width),se=-(L.height*B-L.height)*(Ve/L.height);_e(J,se),j()}function rt(m){if(m.button==0){C.value=!0;let c=te(m);s.landmarks.forEach((B,L)=>{let R=B.getPose();R&&Ie(c,R.marker,Q/a.zoom)&&(_.value=B)})}}function it(m){C.value==!0&&(_.value==null?_e(m.movementX,m.movementY):f.value=te(m),j())}function Oe(m){x.value||(C.value=!1,_.value!=null&&(_.value.setPose(a.index,te(m)),ve()),j())}function dt(){console.log("close context menu"),x.value=!1,ve()}function ve(){_.value=null,f.value={x:-1,y:-1}}function Ie(m,c,B){return Math.sqrt((m.x-c.x)**2+(m.y-c.y)**2)<B}function ut(m){return n.value?m.x>=0&&m.y>=0&&m.x<=n.value.naturalWidth&&m.y<=n.value.naturalHeight:!1}function ct(m){if(console.log("Start context"),x.value=!0,v.value=te(m),!ut(v.value)){m.preventDefault();return}let c=te(m);s.landmarks.forEach((B,L)=>{let R=B.getPose();R&&Ie(c,R.marker,Q/a.zoom)&&(_.value=B)})}function ft(m){m.setPose(a.index,{x:v.value.x,y:v.value.y}),j(),ve()}function pt(){let m=s.generateID(),c=new De(m,m);s.addLandmark(c),c.setPose(a.index,{x:v.value.x,y:v.value.y}),j()}function mt(m){m.removePose(),j()}return(m,c)=>(p(),M("div",{ref_key:"imageContainer",ref:d,class:V(e(w)("relative border w-full h-full flex justify-center items-center overflow-auto",l.class)),onWheel:c[1]||(c[1]=Be(()=>{},["prevent"]))},[i(e(Ze),null,{default:r(()=>[i(e(Ye),{class:"flex w-full h-full"},{default:r(()=>[b("canvas",{ref_key:"canvas",ref:u,tabindex:"1",class:V({"cursor-none":_.value,"cursor-pointer":!_.value}),onMousedown:rt,onMouseup:Oe,onMousemove:it,onMouseout:Oe,onWheel:nt,onContextmenu:ct},null,34)]),_:1}),i(e(Je),{class:"w-64",onCloseAutoFocus:dt},{default:r(()=>[i(e(ka),null,{default:r(()=>c[2]||(c[2]=[P(" Place landmark ")])),_:1}),i(e(Ce)),(p(!0),M(me,null,ge(e(s).landmarks,B=>(p(),y(e(ce),{class:"block",inset:"",onSelect:L=>ft(B)},{default:r(()=>[b("div",Ia,[(p(),M("svg",{class:"h-4 w-4",viewBox:"0 0 8 8",stroke:"currentColor","stroke-width":"1",fill:B.getColorHEX(),xmlns:"http://www.w3.org/2000/svg"},c[3]||(c[3]=[b("circle",{cx:"4",cy:"4",r:"3"},null,-1)]),8,Va)),b("div",ja,K(B.getLabel()),1)])]),_:2},1032,["onSelect"]))),256)),i(e(Ce)),i(e(ce),{class:"block",inset:"",onSelect:pt},{default:r(()=>c[4]||(c[4]=[P(" Add Landmark ")])),_:1}),i(e(Ce)),_.value!=null?(p(),y(e(ce),{key:0,onSelect:c[0]||(c[0]=B=>mt(_.value))},{default:r(()=>[b("div",Ea,[c[6]||(c[6]=b("span",{class:"inline-block align-middle font-bold"},"Delete :",-1)),b("div",qa,[(p(),M("svg",{class:"h-4 w-4",viewBox:"0 0 8 8",stroke:"currentColor","stroke-width":"1",fill:_.value.getColorHEX(),xmlns:"http://www.w3.org/2000/svg"},c[5]||(c[5]=[b("circle",{cx:"4",cy:"4",r:"3"},null,-1)]),8,Ta)),b("span",Ra,K(_.value.getLabel()),1)])])]),_:1})):oe("",!0)]),_:1})]),_:1}),b("img",{ref_key:"base_image",ref:n,class:"hidden",src:e(a).selectedImage.image,alt:"Thumbnail of "+e(a).selectedImage.name,"aspect-ratio":"auto",onLoad:U},null,40,Wa)],34))}}),Le=(o,t)=>{const s=o.__vccOpts||o;for(const[a,l]of t)s[a]=l;return s},Aa=Le(Fa,[["__scopeId","data-v-891379ae"]]),Ha={class:"w-full h-full border flex justify-center items-center"},Ua={key:0,class:"w-full h-full flex justify-center items-center"},Xa={key:1,class:"w-full h-full flex justify-center items-center"},Ka={class:"text-red-600"},Na=g({__name:"CameraViewer",setup(o){const t=Y(),s=E(null),{isPending:a,isError:l,data:d,error:n}=Cs({queryKey:["all_images"],queryFn:()=>h()}),u=ze.get(et.type);function h(){return u.getImages(t.objectPath).then(C=>(console.log("images : length = "+C.images.length),t.images=C.images,t.size=C.size,t.voxel=C.voxel,C))}return(C,_)=>(p(),M("div",Ha,[e(a)?(p(),M("div",Ua,[i(e(Bs),{class:"animate-spin mr-10",width:"10%",height:"10%"})])):oe("",!0),e(l)?(p(),M("div",Xa,[b("div",Ka,K(e(n)),1)])):oe("",!0),e(d)?(p(),M("div",{key:2,ref_key:"imageContainer",ref:s,class:"w-full h-full flex justify-center items-center"},[i(Aa,{class:"object-fit","aspect-ratio":"auto",draggable:"false"})],512)):oe("",!0)]))}}),Ga=Le(Na,[["__scopeId","data-v-27ba982a"]]),Za={class:"h-screen"},Ya={class:"rest_height overflow-auto sidebar rounded-md border p-4"},Ja={class:"rest_width rest_height flex grow items-center justify-center"},Qa=g({__name:"ViewerView",setup(o){const t=Ne(),s=Ps(),a=Y();return console.log("Params : "+s.params),a.setPath(s.params.id),(l,d)=>(p(),M("main",Za,[i(Qs,{class:"sticky menu top-0 flex flex-row grow z-50"}),i(e(Ge)),b("div",{class:V(["h-full flex",e(t).isLeft?"flex-row":"flex-row-reverse"])},[b("div",Ya,[i(e(za))]),b("div",Ja,[i(e(Ga))])],2)]))}}),eo=Le(Qa,[["__scopeId","data-v-e2dad709"]]),to=Ms({history:Ss("/"),routes:[{path:"/:id",name:"viewer",component:eo}]}),st=Ds();st.use(zs);const he=$t(Vs);he.use(st);he.use(to);he.use(Ls);he.mount("#app");export{co as a,io as c,uo as g};
