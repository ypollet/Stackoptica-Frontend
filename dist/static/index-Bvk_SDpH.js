var St=Object.defineProperty;var Mt=(o,e,s)=>e in o?St(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var V=(o,e,s)=>Mt(o,typeof e!="symbol"?e+"":e,s);import{d as tt}from"./vendor_vuedraggable-BozVh_YF.js";import{d as x,c as D,o as m,a as $,w as i,r as P,m as j,u as t,b as n,n as te,g as se,e as B,f as F,h as w,i as zt,j as R,v as Dt,k as jt,l as Vt,p as Et,q as I,t as T,s as ee,x as O,y as N,z as re,A as _e,F as ae,B as oe,C as Tt,D as Lt,E as st,G as at,H as Ne,I as We,J as Ot}from"./vendor_@vue-Dxj_76U5.js";import{C as U,a as ye,d as Ee,t as Ft,c as At,x as W,N as Rt,j as Ht,I as X,H as Nt,K as ot,L as Wt,Q as qt,e as Ut,b as Xt,f as Kt,z as Zt,X as Jt,Z as Gt,U as lt,J as Yt,g as Qt,S as es,_ as ts,h as ce,i as ss,k as as,O as os,l as nt,m as ls,p as ns,n as rs,s as qe,q as is,E as rt,o as it,r as ds,Y as us,u as dt,v as cs,M as fs,w as ps,F as ms,V as gs,y as hs,A as vs,B as _s,D as ys,G as bs,W as ws,P as xs,R as ks,T as $s,$ as Te,a0 as Cs,a1 as Ps,a2 as Is,a3 as Bs,a4 as Ss,a5 as Ms,a6 as zs,a7 as Ds,a8 as js,a9 as Vs,aa as Es,ab as Ts,ac as Ls,ad as Os,ae as Fs,af as As}from"./vendor-DMGauyil.js";import{a as Be,m as Ue,b as Xe,r as de,n as ve,c as Rs,s as Hs,d as Ns,e as Ws}from"./vendor_mathjs-3or9uPxr.js";import"./index-Bvk_SDpH.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function s(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(l){if(l.ep)return;l.ep=!0;const d=s(l);fetch(l.href,d)}})();var Eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function To(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Lo(o){if(o.__esModule)return o;var e=o.default;if(typeof e=="function"){var s=function a(){return this instanceof a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(a){var l=Object.getOwnPropertyDescriptor(o,a);Object.defineProperty(s,a,l.get?l:{enumerable:!0,get:function(){return o[a]}})}),s}class be{constructor(e,s,a,l,d=null){V(this,"id");V(this,"label");V(this,"pose");V(this,"position");V(this,"color");V(this,"show");V(this,"edit");this.id=e,this.label=s,this.pose=a,this.position=l,this.edit=!1,this.color=d||U.rgb([Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)]),this.show=!0}equals(e){return e==null?!1:typeof e=="string"?this.id==e:this.id==e.id}toJSON(){return{id:this.id,label:this.label,color:this.color.hex(),pose:this.pose,position:this.position}}getId(){return this.id}getLabel(){return this.label}setLabel(e){this.label=e}getColorHEX(){return this.color.hex()}setColorHEX(e){this.color=U(e)}setColorRGB(e){e.length<3||(this.color=U.rgb(e[0],e[1],e[2]))}setPose(e,s){this.pose={marker:s,image:e}}getPose(){return this.pose}setPosition(e){this.position=e}getPosition(){return this.position}getEdit(){return this.edit}setEdit(e){this.edit=e}}class we{constructor(e,s=null,a=null){V(this,"label");V(this,"landmarks");V(this,"color");V(this,"edit_label");V(this,"edit_distance");V(this,"show");this.label=e,this.landmarks=s||new Array,this.edit_label=!1,this.edit_distance=!1,this.show=!0,this.color=a||U.rgb([Math.floor(Math.random()*256),Math.floor(Math.random()*256),Math.floor(Math.random()*256)])}get distance(){if(this.landmarks.length<2)return;let e=new Array;for(let s=1;s<this.landmarks.length;s++)e.push([Be(this.landmarks[s].position.x-this.landmarks[s-1].position.x),Be(this.landmarks[s].position.y-this.landmarks[s-1].position.y),Be(this.landmarks[s].position.z-this.landmarks[s-1].position.z)]);return console.log(e.length),e}in(e){return this.landmarks.some(s=>s.equals(e))}reset(){this.landmarks=new Array}remove(e){this.landmarks=this.landmarks.filter(s=>!s.equals(e))}getColorHEX(){return this.color.hex()}setColorHEX(e){this.color=U(e)}setColorRGB(e){e.length<3||(this.color=U.rgb(e[0],e[1],e[2]))}toJSON(){return{label:this.label,color:this.color.hex(),landmarks:this.landmarks.map(e=>e.toJSON())}}}class qs{constructor(e){V(this,"provider");this.provider=e}computeLandmarkPosition(e,s){return this.provider.computeLandmarkPosition(e,s).then(a=>a.data)}async getImages(e){return this.provider.getImages(e).then(s=>{let a=s.data;return a.individualImages=new Map(Object.entries(a.individualImages)),a})}getFullImage(e,s){return this.provider.getFullImage(e,s)}getThumbnail(e,s){return this.provider.getThumbnail(e,s)}}class Us{constructor(e){V(this,"server");this.server=e}async getImages(e){const s=this.server+"/"+e+"/images";return ye.get(s)}getFullImage(e,s){return this.server+"/"+e+"/"+s+"/full-image"}getThumbnail(e,s){return this.server+"/"+e+"/"+s+"/thumbnail"}async computeLandmarkPosition(e,s){const a=this.server+"/"+e+"/"+s.image.name+"/position?x="+s.marker.x+"&y="+s.marker.y;return ye.get(a)}}class Xs{constructor(e){V(this,"server");this.server=e}async getImages(e){const s=this.server+"/stackoptica/"+e+"/images";return ye.get(s)}getFullImage(e,s){return this.server+"/stackoptica/"+s+"/full-image"}getThumbnail(e,s){return this.server+"/stackoptica/"+s+"/thumbnail"}async computeLandmarkPosition(e,s){const a=this.server+"/stackoptica/"+s.image.name+"/position?x="+s.marker.x+"&y="+s.marker.y;return ye.get(a)}}const je={type:"ORTHANC",url:"http://localhost:8042"},Le={type:"DATA"};class ut{static get(e){if(this._instances.get(e)==null){if(e=="WEB")return new Us(je.url);if(e=="ORTHANC")return new Xs(je.url)}return this._instances.get(e)}}V(ut,"_instances",new Map);class xe{static get(e){return this._instances.get(e)==null&&e=="DATA"?new qs(ut.get(je.type)):this._instances.get(e)}}V(xe,"_instances",new Map);xe.get(Le.type);const ct=Ee("settings",{state:()=>({isLeft:!1}),actions:{useToggleLeft(o){this.isLeft=o}},persist:{storage:localStorage,key:"settings"}}),G=Ee("images",{state:()=>({objectPath:"",image:"stack",index:0,stackImages:new Array,individualImages:new Map,size:{width:-1,height:-1},zoom:-1,offset:{x:0,y:0},zoomRect:{top:0,left:0,width:0,height:0}}),getters:{selectedImage:o=>o.index>=0&&o.index<o.stackImages.length&&o.image=="stack"?o.stackImages[o.index]:o.individualImages.has(o.image)?o.individualImages.get(o.image):{name:"RBINS Logo",label:"RBINS",thumbnail:"",image:"https://www.naturalsciences.be/bundles/8c62adb1e0fbef009ef7c06c69a991890012e203/img/logos/logo.svg"}},actions:{setPath(o){this.$reset(),this.objectPath=o},setIndex(o){this.index=Ue(Xe(0,o),this.stackImages.length-1)},moveIndex(o){this.index=Ue(Xe(0,this.index+o),this.stackImages.length-1)},increment(){this.moveIndex(1)},decrement(){this.moveIndex(-1)},getImageName(o){return o>=0&&o<this.stackImages.length?this.stackImages[o].name:"Image "+o}},persist:{storage:sessionStorage,key:"images"}}),le=Ee("landmarks",{state:()=>({landmarks:Array(),distances:Array(),adjustFactor:1,scale:"mm",tab:"landmarks",selectedDistanceIndex:-1}),getters:{indexes:o=>new Map(o.distances.map((e,s)=>[e.label,s])),selectedDistance:o=>o.selectedDistanceIndex>=0&&o.selectedDistanceIndex<o.distances.length?o.distances[o.selectedDistanceIndex]:null},actions:{generateID(){let o=!1,e="";for(;!o;)e=(Math.random()+1).toString(36).substring(2),this.distances.forEach(s=>{s.landmarks.filter(a=>a.equals(e)).length==0&&(o=!0)}),this.landmarks.filter(s=>s.equals(e)).length==0&&(o=!0);return e}},persist:{storage:sessionStorage,key:"landmarks",afterHydrate:o=>{let e=new Array;o.store.$state.landmarks.forEach(a=>{let l=new be(a.id,a.label,a.pose,a.position,U(a.color));e.push(l)}),o.store.$state.landmarks=e;let s=new Array;o.store.$state.distances.forEach(a=>{let l=a.landmarks.map(f=>new be(f.id,f.label,f.pose,f.position,U(f.color))),d=new we(a.label,l,U(a.color));s.push(d)}),o.store.$state.distances=s}}});function C(...o){return Ft(At(o))}var ue=(o=>(o[o.m=1e3]="m",o[o.dm=100]="dm",o[o.cm=10]="cm",o[o.mm=1]="mm",o[o.µm=.001]="µm",o[o.nm=1e-6]="nm",o))(ue||{});const Ks=.1,Zs=4,Ke=4.5,H=.2,Js=x({__name:"Menubar",props:{modelValue:{},defaultValue:{},dir:{},loop:{type:Boolean},class:{}},emits:["update:modelValue"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(Rt),j(t(d),{class:t(C)("flex h-10 items-center gap-x-1 rounded-md border bg-background p-1",s.class)}),{default:i(()=>[P(f.$slots,"default")]),_:3},16,["class"]))}}),ie=x({__name:"MenubarItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},emits:["select"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(Ht),j(t(d),{class:t(C)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",f.inset&&"pl-8",s.class)}),{default:i(()=>[P(f.$slots,"default")]),_:3},16,["class"]))}}),Se=x({__name:"MenubarContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:8},align:{default:"start"},alignOffset:{default:-4},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(ot),null,{default:i(()=>[n(t(Nt),j(t(a),{class:t(C)("z-50 min-w-48 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e.class)}),{default:i(()=>[P(l.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Me=x({__name:"MenubarMenu",props:{value:{}},setup(o){const e=o;return(s,a)=>(m(),$(t(Wt),te(se(e)),{default:i(()=>[P(s.$slots,"default")]),_:3},16))}}),Gs=x({__name:"MenubarSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(o,{emit:e}){const l=W(o,e);return(d,f)=>(m(),$(t(qt),te(se(t(l))),{default:i(()=>[P(d.$slots,"default")]),_:3},16))}}),Ys=x({__name:"MenubarSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(ot),null,{default:i(()=>[n(t(Ut),j(t(d),{class:t(C)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s.class)}),{default:i(()=>[P(f.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Qs=x({__name:"MenubarSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(Kt),j(t(a),{class:t(C)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",l.inset&&"pl-8",e.class)}),{default:i(()=>[P(l.$slots,"default"),n(t(Xt),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),ze=x({__name:"MenubarTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(Zt),j(t(a),{class:t(C)("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e.class)}),{default:i(()=>[P(l.$slots,"default")]),_:3},16,["class"]))}}),Ze=x({__name:"MenubarShortcut",props:{class:{}},setup(o){const e=o;return(s,a)=>(m(),B("span",{class:F(t(C)("ml-auto text-xs tracking-widest text-muted-foreground",e.class))},[P(s.$slots,"default")],2))}}),De=x({__name:"MenubarLabel",props:{asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(o){const e=o;return(s,a)=>(m(),$(t(Jt),{class:F(t(C)("px-2 py-1.5 text-sm font-semibold",s.inset&&"pl-8",e.class))},{default:i(()=>[P(s.$slots,"default")]),_:3},8,["class"]))}}),ea=x({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:e}){const l=W(o,e);return(d,f)=>(m(),$(t(Gt),te(se(t(l))),{default:i(()=>[P(d.$slots,"default")]),_:3},16))}}),ta=x({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(o){const e=o;return(s,a)=>(m(),$(t(lt),te(se(e)),{default:i(()=>[P(s.$slots,"default")]),_:3},16))}}),sa=x({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(o){const e=o;return(s,a)=>(m(),$(t(Yt),te(se(e)),{default:i(()=>[P(s.$slots,"default")]),_:3},16))}}),aa=x({__name:"DialogHeader",props:{class:{}},setup(o){const e=o;return(s,a)=>(m(),B("div",{class:F(t(C)("flex flex-col gap-y-1.5 text-center sm:text-left",e.class))},[P(s.$slots,"default")],2))}}),oa=x({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(Qt),j(t(a),{class:t(C)("text-lg font-semibold leading-none tracking-tight",e.class)}),{default:i(()=>[P(l.$slots,"default")]),_:3},16,["class"]))}}),la=x({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(es),j(t(a),{class:t(C)("text-sm text-muted-foreground",e.class)}),{default:i(()=>[P(l.$slots,"default")]),_:3},16,["class"]))}}),na=x({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(as),null,{default:i(()=>[n(t(ts),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),n(t(ss),j(t(d),{class:t(C)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s.class)}),{default:i(()=>[P(f.$slots,"default"),n(t(lt),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:i(()=>[n(t(ce),{class:"w-4 h-4"}),c[0]||(c[0]=w("span",{class:"sr-only"},"Close",-1))]),_:1})]),_:3},16,["class"])]),_:3}))}}),ra=x({__name:"DialogFooter",props:{class:{}},setup(o){const e=o;return(s,a)=>(m(),B("div",{class:F(t(C)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",e.class))},[P(s.$slots,"default")],2))}}),fe=x({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(o,{emit:e}){const s=o,l=zt(s,"modelValue",e,{passive:!0,defaultValue:s.defaultValue});return(d,f)=>R((m(),B("input",{"onUpdate:modelValue":f[0]||(f[0]=c=>jt(l)?l.value=c:null),class:F(t(C)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s.class))},null,2)),[[Dt,t(l)]])}}),q=x({__name:"Button",props:{variant:{},size:{},as:{default:"button"},class:{},asChild:{type:Boolean}},setup(o){const e=o;return(s,a)=>(m(),$(t(os),{as:s.as,"as-child":s.asChild,class:F(t(C)(t(ia)({variant:s.variant,size:s.size}),e.class))},{default:i(()=>[P(s.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),ia=nt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Y=x({__name:"Label",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:a,...l}=e;return l});return(a,l)=>(m(),$(t(ls),j(s.value,{class:t(C)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e.class)}),{default:i(()=>[P(a.$slots,"default")]),_:3},16,["class"]))}}),Je=x({__name:"Switch",props:{defaultChecked:{type:Boolean},checked:{type:Boolean},disabled:{type:Boolean},required:{type:Boolean},name:{},id:{},value:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:checked"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(rs),j(t(d),{class:t(C)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s.class)}),{default:i(()=>[n(t(ns),{class:F(t(C)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"))},null,8,["class"])]),_:1},16,["class"]))}}),da={class:"flex flex-row justify-between h-full w-full"},ua={class:"flex flex-row justify-between h-full w-full"},ca=x({__name:"Menu",setup(o){const e=ct(),s=le(),a=G(),l=Vt({storageKey:"localStorage"}),d=Et(l);function f(){const p=[["Distance","Label","Color","Pose_X","Pose_Y","Image","ImageLabel","X","Y","Z"]];s.distances.forEach(k=>{k.landmarks.forEach(M=>{M=M;let K=M.pose,A=M.position,ne=[k.label,M.label,M.getColorHEX(),K.marker.x.toString(),K.marker.y.toString(),K.image.name,K.image.label,A.x.toString(),A.y.toString(),A.z.toString()];p.push(ne)})});let g=p.map(k=>k.join(";")).join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"});qe(v,"landmarks_"+a.objectPath+".csv")}function c(){const p=new Map;p.set("scale_factor",s.adjustFactor);let g=new Array;s.distances.forEach(k=>{let M=new Array;k.landmarks.forEach(A=>{M.push({id:A.id,label:A.label,color:A.getColorHEX(),pose:A.pose})});let K={label:k.label,color:k.getColorHEX(),landmarks:JSON.parse(JSON.stringify(M))};g.push(K)}),p.set("distances",g);var v=new Blob([JSON.stringify(Object.fromEntries(p.entries()))],{type:"application/json;charset=utf-8"});qe(v,"landmarks_"+a.objectPath+"_"+new Date().getTime()+".json")}function h(p){p.preventDefault();let k=p.target.elements[0].files[0];k&&k.text().then(M=>{_(M)}).catch(M=>{console.error(M)})}function _(p){let g=JSON.parse(p),v=new Map(Object.entries(g));s.adjustFactor=v.get("scale_factor"),v.get("landmarks").forEach((M,K)=>{let A=new Map(Object.entries(M)),ne=A.get("landmarks").map(Z=>{let E=new Map(Object.entries(Z));return new be(s.generateID(),E.get("label"),E.get("pose"),E.get("position"),U(E.get("color")))}),pe=new we(A.get("label"),ne,U(A.get("color")));s.distances.push(pe)})}return(p,g)=>(m(),B("div",null,[n(t(ea),null,{default:i(()=>[n(t(Js),{class:"rounded border-b z-100 h-10"},{default:i(()=>[n(t(Me),null,{default:i(()=>[n(t(ze),{class:"relative"},{default:i(()=>g[0]||(g[0]=[I(" File ")])),_:1}),n(t(Se),null,{default:i(()=>[n(t(De),null,{default:i(()=>g[1]||(g[1]=[I(" Landmarks ")])),_:1}),n(t(sa),{asChild:""},{default:i(()=>[n(t(ie),{inset:""},{default:i(()=>g[2]||(g[2]=[I("Import")])),_:1})]),_:1}),n(t(Gs),null,{default:i(()=>[n(t(Qs),{inset:""},{default:i(()=>g[3]||(g[3]=[I("Export")])),_:1}),n(t(Ys),null,{default:i(()=>[n(t(ie),{onSelect:f},{default:i(()=>g[4]||(g[4]=[I(" CSV ")])),_:1}),n(t(ie),{onSelect:c},{default:i(()=>g[5]||(g[5]=[I(" JSON ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(t(Me),null,{default:i(()=>[n(t(ze),null,{default:i(()=>g[6]||(g[6]=[I("Edit")])),_:1}),n(t(Se),null,{default:i(()=>[n(t(ie),{disabled:""},{default:i(()=>[g[8]||(g[8]=I(" Undo ")),n(t(Ze),null,{default:i(()=>g[7]||(g[7]=[I("⌘Z")])),_:1})]),_:1}),n(t(ie),{disabled:""},{default:i(()=>[g[10]||(g[10]=I(" Redo ")),n(t(Ze),null,{default:i(()=>g[9]||(g[9]=[I("⇧⌘Z")])),_:1})]),_:1})]),_:1})]),_:1}),n(t(Me),null,{default:i(()=>[n(t(ze),null,{default:i(()=>g[11]||(g[11]=[I(" Settings ")])),_:1}),n(t(Se),null,{default:i(()=>[n(t(De),{inset:""},{default:i(()=>[w("div",da,[g[12]||(g[12]=w("span",null,"Dark Mode :",-1)),n(t(Je),{checked:t(l),"onUpdate:checked":t(d),class:"inline-block align-middle ml-auto"},null,8,["checked","onUpdate:checked"])])]),_:1}),n(t(De),{inset:""},{default:i(()=>[w("div",ua,[g[13]||(g[13]=w("span",null,"Reverse Mode :",-1)),n(t(Je),{checked:t(e).isLeft,"onUpdate:checked":t(e).useToggleLeft,class:"inline-block align-middle self-end"},null,8,["checked","onUpdate:checked"])])]),_:1})]),_:1})]),_:1})]),_:1}),n(t(na),null,{default:i(()=>[n(t(aa),null,{default:i(()=>[n(t(oa),null,{default:i(()=>g[14]||(g[14]=[I("Add the landmark file")])),_:1}),n(t(la),null,{default:i(()=>g[15]||(g[15]=[I("Add the json files containing the landmarks")])),_:1})]),_:1}),w("form",{onSubmit:h},[n(t(Y),null,{default:i(()=>g[16]||(g[16]=[I("File")])),_:1}),n(t(fe),{type:"file",placeholder:"your landmark json file"}),n(t(ra),null,{default:i(()=>[n(t(ta),{"as-child":""},{default:i(()=>[n(t(q),{type:"submit"},{default:i(()=>g[17]||(g[17]=[I("Confirm")])),_:1})]),_:1})]),_:1})],32)]),_:1})]),_:1})]))}}),ke=x({__name:"Separator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{},label:{}},setup(o){const e=o,s=D(()=>{const{class:a,...l}=e;return l});return(a,l)=>(m(),$(t(is),j(s.value,{class:t(C)("shrink-0 bg-border relative",e.orientation==="vertical"?"w-px h-full":"h-px w-full",e.class)}),{default:i(()=>[e.label?(m(),B("span",{key:0,class:F(t(C)("text-xs text-muted-foreground bg-background absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex justify-center items-center",e.orientation==="vertical"?"w-[1px] px-1 py-2":"h-[1px] py-1 px-2"))},T(e.label),3)):ee("",!0)]),_:1},16,["class"]))}}),fa={class:"scroll-align border flex grow p-2"},pa={class:"h-12 flex grow flex-row justify-between items-center font-normal px-3 py-2"},ma={class:"flex flex-row w-full items-center justify-start space-x-3 py-3 mr-3"},ga=["value","onChange"],ha={class:"flex items-center h-full w-auto justify-end space-x-3 pr-3"},va={class:"flex items-center justify-end"},_a=x({__name:"LandmarkList",setup(o){const e=le();G();const s=O(!0),a=O(null),l=O(null);function d(h,_){let p=h.currentTarget;p!=null&&_.setColorHEX(p.value)}function f(h,_){_.setLabel(h.toString())}function c(h){e.landmarks=e.landmarks.filter(_=>!_.equals(h))}return(h,_)=>(m(),B("div",{ref_key:"landmarksScroll",ref:l,class:F(["overflow-auto min-h-16 max-h-96 w-full border",{"scroll-snap-type":s.value}])},[n(t(tt),{ref_key:"landmarksElements",ref:a,modelValue:t(e).landmarks,"onUpdate:modelValue":_[1]||(_[1]=p=>t(e).landmarks=p),group:"landmarks","item-key":"id","force-fallback":!0,animation:150,scroll:!0,bubbleScroll:!0,handle:".handle",class:"relative w-fit min-w-full",onStart:_[2]||(_[2]=p=>s.value=!1),onEnd:_[3]||(_[3]=p=>s.value=!0)},{item:i(({element:p})=>[w("div",fa,[w("div",pa,[w("div",ma,[_[4]||(_[4]=w("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",class:"flex-none mr-2 h-6 w-6 handle"},[w("path",{d:"M7.49985 0.877045C3.84216 0.877045 0.877014 3.84219 0.877014 7.49988C0.877014 11.1575 3.84216 14.1227 7.49985 14.1227C11.1575 14.1227 14.1227 11.1575 14.1227 7.49988C14.1227 3.84219 11.1575 0.877045 7.49985 0.877045ZM1.82701 7.49988C1.82701 4.36686 4.36683 1.82704 7.49985 1.82704C10.6328 1.82704 13.1727 4.36686 13.1727 7.49988C13.1727 10.6329 10.6328 13.1727 7.49985 13.1727C4.36683 13.1727 1.82701 10.6329 1.82701 7.49988ZM7.49999 9.49999C8.60456 9.49999 9.49999 8.60456 9.49999 7.49999C9.49999 6.39542 8.60456 5.49999 7.49999 5.49999C6.39542 5.49999 5.49999 6.39542 5.49999 7.49999C5.49999 8.60456 6.39542 9.49999 7.49999 9.49999Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})],-1)),w("input",{type:"color",class:"flex-none h-8 w-8 block bg-white border border-gray-950 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-300",id:"hs-color-input",value:p.getColorHEX(),title:"Choose your color",onChange:g=>d(g,p)},null,40,ga),R(n(t(Y),{class:"whitespace-nowrap",onDblclick:re(g=>p.setEdit(!0),["stop"])},{default:i(()=>[I(T(p.label),1)]),_:2},1032,["onDblclick"]),[[N,!p.getEdit()]]),R(n(t(fe),{onDblclick:_[0]||(_[0]=re(()=>{},["stop"])),type:"text","model-value":p.label,class:"flew grow h-auto",onFocusout:g=>p.setEdit(!1),onKeyup:_e(g=>p.setEdit(!1),["enter"]),"onUpdate:modelValue":g=>f(g,p)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[N,p.getEdit()]])]),w("div",ha,[n(ke,{orientation:"vertical",class:"h-full w-0.5"}),n(t(Y),{class:"whitespace-nowrap"},{default:i(()=>[I(T(p.pose.image.label),1)]),_:2},1024)]),w("div",va,[R(n(t(q),{class:"w-6 h-6 p-0 mr-3",variant:"secondary",onClick:g=>p.show=!1},{default:i(()=>[n(t(rt),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"]),[[N,p.show]]),R(n(t(q),{class:"w-6 h-6 p-0 mr-3",variant:"secondary",onClick:g=>p.show=!0},{default:i(()=>[n(t(it),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"]),[[N,!p.show]]),n(t(q),{class:"w-6 h-6 p-0",variant:"destructive",onClick:g=>c(p.getId())},{default:i(()=>[n(t(ce),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"])])])])]),_:1},8,["modelValue"])],2))}}),ft=x({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},dir:{},name:{},autocomplete:{},disabled:{type:Boolean},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(o,{emit:e}){const l=W(o,e);return(d,f)=>(m(),$(t(ds),te(se(t(l))),{default:i(()=>[P(d.$slots,"default")]),_:3},16))}}),pt=x({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(o){const e=o;return(s,a)=>(m(),$(t(us),te(se(e)),{default:i(()=>[P(s.$slots,"default")]),_:3},16))}}),mt=x({__name:"SelectTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(fs),j(t(a),{class:t(C)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e.class)}),{default:i(()=>[P(l.$slots,"default"),n(t(cs),{"as-child":""},{default:i(()=>[n(t(dt),{class:"w-4 h-4 opacity-50"})]),_:1})]),_:3},16,["class"]))}}),gt=x({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(gs),null,{default:i(()=>[n(t(ms),j({...t(d),...f.$attrs},{class:t(C)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",f.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s.class)}),{default:i(()=>[n(t(ba)),n(t(ps),{class:F(t(C)("p-1",f.position==="popper"&&"h-[--radix-select-trigger-height] w-full min-w-[--radix-select-trigger-width]"))},{default:i(()=>[P(f.$slots,"default")]),_:3},8,["class"]),n(t(wa))]),_:3},16,["class"])]),_:3}))}}),ht=x({__name:"SelectGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:a,...l}=e;return l});return(a,l)=>(m(),$(t(hs),j({class:t(C)("p-1 w-full",e.class)},s.value),{default:i(()=>[P(a.$slots,"default")]),_:3},16,["class"]))}}),ya={class:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},Ve=x({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(bs),j(t(a),{class:t(C)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e.class)}),{default:i(()=>[w("span",ya,[n(t(_s),null,{default:i(()=>[n(t(vs),{class:"h-4 w-4"})]),_:1})]),n(t(ys),null,{default:i(()=>[P(l.$slots,"default")]),_:3})]),_:3},16,["class"]))}}),vt=x({__name:"SelectLabel",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o;return(s,a)=>(m(),$(t(ws),{class:F(t(C)("py-1.5 pl-8 pr-2 text-sm font-semibold",e.class))},{default:i(()=>[P(s.$slots,"default")]),_:3},8,["class"]))}}),ba=x({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(ks),j(t(a),{class:t(C)("flex cursor-default items-center justify-center py-1",e.class)}),{default:i(()=>[P(l.$slots,"default",{},()=>[n(t(xs),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),wa=x({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t($s),j(t(a),{class:t(C)("flex cursor-default items-center justify-center py-1",e.class)}),{default:i(()=>[P(l.$slots,"default",{},()=>[n(t(dt),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),xa={class:"flex grow w-full flex-col space-y-5"},ka=x({__name:"DistanceList",setup(o){const e=le(),{selectedDistanceIndex:s}=Te(e);function a(l){e.selectedDistanceIndex=Number(l)}return(l,d)=>(m(),B("div",xa,[n(t(ft),{class:"flex grow w-full","model-value":t(s).toString(),"onUpdate:modelValue":a},{default:i(()=>[n(t(mt),{class:"w-full"},{default:i(()=>[n(t(pt),{placeholder:"Pick a distance"})]),_:1}),n(t(gt),null,{default:i(()=>[n(t(ht),null,{default:i(()=>[n(t(vt),null,{default:i(()=>d[0]||(d[0]=[I("Scale")])),_:1}),n(t(Ve),{class:"h-8",value:"-1"}),(m(!0),B(ae,null,oe(t(e).distances,(f,c)=>(m(),$(t(Ve),{class:"h-8",value:c.toString()},{default:i(()=>[I(T(f.label),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["model-value"]),t(e).selectedDistance!=null?(m(),$(t(Ge),{key:0,distance:t(e).selectedDistance,index:t(e).selectedDistanceIndex,showLandmarks:!0},null,8,["distance","index"])):ee("",!0),(m(!0),B(ae,null,oe(t(e).distances.map((f,c)=>[f,c]).filter(f=>f[1]!=t(e).selectedDistanceIndex),f=>(m(),B("div",null,[f[1]!=t(e).selectedDistanceIndex?(m(),$(t(Ge),{key:0,distance:f[0],index:f[1],showLandmarks:!1,onDblclick:c=>t(e).selectedDistanceIndex=f[1]},null,8,["distance","index","onDblclick"])):ee("",!0)]))),256))]))}}),$a={class:"w-full"},Ca={class:"flex flex-row"},Pa={class:"w-full h-full flex justify-end space-x-2"},Ia={class:"flex min-h-48 min-w-full w-fit flex flex-col border"},Ba={class:"flex flex-col min-w-full w-fit h-10"},Sa={class:"flex flex-row items-center justify-between space-x-3 px-3 w-full h-full"},Ma={class:"flex flex-row items-center justify-start space-x-3"},za={class:"flex flex-row items-center justify-end space-x-3"},Da=.01,ja=x({__name:"DistanceComputed",setup(o){const e=le();G();function s(d){let f=0;return d.forEach(c=>{let h=Rs(c,Hs),_=Ns(h);f+=Ws(_)}),f}function a(d,f){e.adjustFactor=ve(d)/s(f.distance)*ve(ue[e.scale])}function l(){e.adjustFactor=1}return(d,f)=>(m(),B("div",$a,[w("div",Ca,[f[3]||(f[3]=w("h2",{class:"flex items-center px-7 text-lg font-semibold tracking-tight"}," Measures ",-1)),w("div",Pa,[n(t(ft),{modelValue:t(e).scale,"onUpdate:modelValue":f[0]||(f[0]=c=>t(e).scale=c)},{default:i(()=>[n(t(mt),{class:"w-16"},{default:i(()=>[n(t(pt),{placeholder:"Pick a scale"})]),_:1}),n(t(gt),null,{default:i(()=>[n(t(ht),null,{default:i(()=>[n(t(vt),null,{default:i(()=>f[1]||(f[1]=[I("Scale")])),_:1}),(m(!0),B(ae,null,oe(Object.keys(t(ue)).filter(c=>isNaN(Number(c))),c=>(m(),$(t(Ve),{value:c},{default:i(()=>[I(T(c),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(t(q),{variant:"secondary",onClick:l},{default:i(()=>f[2]||(f[2]=[I(" Reset Scale ")])),_:1})])]),w("div",Ia,[(m(!0),B(ae,null,oe(t(e).distances,(c,h)=>(m(),B("div",Ba,[w("div",Sa,[w("div",Ma,[n(t(Y),{class:"flex whitespace-nowrap w-auto"},{default:i(()=>[I(T(c.label),1)]),_:2},1024)]),w("div",za,[R(n(t(Y),{class:"flex whitespace-nowrap w-auto",onDblclick:_=>c.edit_distance=!0},{default:i(()=>[I(T(de(c.distance?s(c.distance)*t(e).adjustFactor/ve(t(ue)[t(e).scale]):0,5))+" "+T(t(e).scale),1)]),_:2},1032,["onDblclick"]),[[N,!c.edit_distance]]),R(n(t(fe),{type:"number",min:0,step:Da,"model-value":c.distance?s(c.distance)*t(e).adjustFactor/ve(t(ue)[t(e).scale]):0,class:"flex h-auto w-auto px-0",onFocusout:_=>c.edit_distance=!1,onKeyup:_e(_=>c.edit_distance=!1,["enter"]),"onUpdate:modelValue":_=>a(_,c)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[N,c.edit_distance]]),n(t(q),{class:"relative w-6 h-6 p-0",variant:"destructive",onClick:_=>t(e).distances.splice(h,1)},{default:i(()=>[n(t(ce),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"])])]),n(t(ke),{class:"w-full"})]))),256))])]))}}),Va={class:"flex pr-2 py-2 border-transparent border-2"},Ea={class:"flex grow row justify-between items-center pr-3 py-2"},Ta={class:"flex grow row w-full justify-start items-center space-x-3 mr-3"},La=["value"],Oa={class:"flex row justify-end space-x-3"},Fa={class:"scroll-align border flex grow p-2"},Aa={class:"h-12 flex grow row justify-between items-center font-normal px-3 py-2"},Ra={class:"flex items-center justify-start w-full space-x-3 py-3 mr-3"},Ha={class:"flex items-center h-full w-auto justify-end space-x-3 pr-3"},Na={class:"flex items-center justify-end space-x-3"},Ge=x({__name:"DistanceIteration",props:{distance:{type:we,required:!0},index:{type:Number,required:!0},showLandmarks:{type:Boolean,default:!0}},setup(o){const e=o,s=le();G();const a=O(!0),l=O(null),d=O(null);function f(g){let v=g.currentTarget;v!=null&&(e.distance.setColorHEX(v.value),e.distance.landmarks.forEach(k=>k.setColorHEX(v.value)))}function c(g){e.distance.remove(g),e.distance.landmarks.length==0&&s.distances.splice(e.index,1)}function h(g,v){v.setLabel(g.toString())}function _(g){e.distance.label=g.toString()}function p(){e.index<=s.selectedDistanceIndex&&s.selectedDistanceIndex--,s.distances.splice(e.index,1)}return(g,v)=>(m(),B("div",null,[w("div",Va,[w("div",Ea,[w("div",Ta,[w("input",{type:"color",class:"h-8 w-8 block bg-white border border-gray-950 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-300",id:"hs-color-input",value:e.distance.getColorHEX(),title:"Choose your color",onChange:v[0]||(v[0]=k=>f(k))},null,40,La),R(n(t(Y),{class:"flex whitespace-nowrap w-36 font-normal text-lg",onDblclick:v[1]||(v[1]=k=>e.distance.edit_label=!0)},{default:i(()=>[I(T(e.distance.label),1)]),_:1},512),[[N,!e.distance.edit_label]]),R(n(t(fe),{type:"text","model-value":e.distance.label,class:"flex h-auto w-full px-0",onFocusout:v[2]||(v[2]=k=>e.distance.edit_label=!1),onKeyup:v[3]||(v[3]=_e(k=>e.distance.edit_label=!1,["enter"])),"onUpdate:modelValue":v[4]||(v[4]=k=>_(k))},null,8,["model-value"]),[[N,e.distance.edit_label]])]),w("div",Oa,[R(n(t(q),{class:"relative w-6 h-6 p-0",variant:"secondary",onClick:v[5]||(v[5]=k=>e.distance.show=!1)},{default:i(()=>[n(t(rt),{class:"relative w-4 h-4 p-0"})]),_:1},512),[[N,e.distance.show]]),R(n(t(q),{class:"relative w-6 h-6 p-0",variant:"secondary",onClick:v[6]||(v[6]=k=>e.distance.show=!0)},{default:i(()=>[n(t(it),{class:"relative w-4 h-4 p-0"})]),_:1},512),[[N,!e.distance.show]]),n(t(q),{class:"relative w-6 h-6 p-0",variant:"secondary",onClick:v[7]||(v[7]=k=>e.distance.reset())},{default:i(()=>[n(t(Cs),{class:"relative w-4 h-4 p-0"})]),_:1}),n(t(q),{class:"relative w-6 h-6 p-0",variant:"destructive",onClick:v[8]||(v[8]=k=>p())},{default:i(()=>[n(t(ce),{class:"relative w-4 h-4 p-0"})]),_:1})])])]),o.showLandmarks?(m(),B("div",{key:0,ref_key:"landmarksScroll",ref:d,class:F(["overflow-auto min-h-16 max-h-96 w-full border",{"scroll-snap-type":a.value}])},[n(t(tt),{ref_key:"landmarksElements",ref:l,modelValue:o.distance.landmarks,"onUpdate:modelValue":v[10]||(v[10]=k=>o.distance.landmarks=k),group:o.distance.label+"_landmarks_"+o.index,"item-key":"id","force-fallback":!0,animation:150,scroll:!0,bubbleScroll:!0,handle:".handle",class:"relative w-fit min-w-full",onStart:v[11]||(v[11]=k=>a.value=!1),onEnd:v[12]||(v[12]=k=>a.value=!0)},{item:i(({element:k})=>[w("div",Fa,[w("div",Aa,[w("div",Ra,[v[13]||(v[13]=w("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-6 w-6 handle"},[w("path",{d:"M7.49985 0.877045C3.84216 0.877045 0.877014 3.84219 0.877014 7.49988C0.877014 11.1575 3.84216 14.1227 7.49985 14.1227C11.1575 14.1227 14.1227 11.1575 14.1227 7.49988C14.1227 3.84219 11.1575 0.877045 7.49985 0.877045ZM1.82701 7.49988C1.82701 4.36686 4.36683 1.82704 7.49985 1.82704C10.6328 1.82704 13.1727 4.36686 13.1727 7.49988C13.1727 10.6329 10.6328 13.1727 7.49985 13.1727C4.36683 13.1727 1.82701 10.6329 1.82701 7.49988ZM7.49999 9.49999C8.60456 9.49999 9.49999 8.60456 9.49999 7.49999C9.49999 6.39542 8.60456 5.49999 7.49999 5.49999C6.39542 5.49999 5.49999 6.39542 5.49999 7.49999C5.49999 8.60456 6.39542 9.49999 7.49999 9.49999Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})],-1)),R(n(t(Y),{class:"whitespace-nowrap",onDblclick:re(M=>k.setEdit(!0),["stop"])},{default:i(()=>[I(T(k.label),1)]),_:2},1032,["onDblclick"]),[[N,!k.getEdit()]]),R(n(t(fe),{onDblclick:v[9]||(v[9]=re(()=>{},["stop"])),type:"text","model-value":k.label,class:"h-auto",onFocusout:M=>k.setEdit(!1),onKeyup:_e(M=>k.setEdit(!1),["enter"]),"onUpdate:modelValue":M=>h(M,k)},null,8,["model-value","onFocusout","onKeyup","onUpdate:modelValue"]),[[N,k.getEdit()]])]),w("div",Ha,[n(ke,{orientation:"vertical",class:"h-full w-0.5"}),n(t(Y),{class:"whitespace-nowrap"},{default:i(()=>[I(T(k.pose.image.label),1)]),_:2},1024)]),w("div",Na,[n(t(q),{class:"relative w-6 h-6 p-0",variant:"destructive",onClick:M=>c(k.id)},{default:i(()=>[n(t(ce),{class:"relative w-4 h-4 p-0"})]),_:2},1032,["onClick"])])])])]),_:1},8,["modelValue","group"])],2)):ee("",!0)]))}}),Wa=x({__name:"Slider",props:{name:{},defaultValue:{},modelValue:{},disabled:{type:Boolean},orientation:{},dir:{},inverted:{type:Boolean},min:{},max:{},step:{},minStepsBetweenThumbs:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","valueCommit"],setup(o,{emit:e}){const s=o,a=e,l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(Ss),j({class:t(C)("relative flex w-full touch-none select-none items-center",s.class)},t(d)),{default:i(()=>[n(t(Is),{class:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary"},{default:i(()=>[n(t(Ps),{class:"absolute h-full bg-primary"})]),_:1}),(m(!0),B(ae,null,oe(f.modelValue,(h,_)=>(m(),$(t(Bs),{key:_,class:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}))),128))]),_:1},16,["class"]))}}),qa=x({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},asChild:{type:Boolean},as:{}},emits:["update:modelValue"],setup(o,{emit:e}){const l=W(o,e);return(d,f)=>(m(),$(t(Ms),te(se(t(l))),{default:i(()=>[P(d.$slots,"default")]),_:3},16))}}),Ye=x({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:l,...d}=e;return d}),a=X(s);return(l,d)=>(m(),$(t(zs),j(t(a),{class:t(C)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e.class)}),{default:i(()=>[P(l.$slots,"default")]),_:3},16,["class"]))}}),Ua=x({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:a,...l}=e;return l});return(a,l)=>(m(),$(t(Ds),j(s.value,{class:t(C)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e.class)}),{default:i(()=>[P(a.$slots,"default")]),_:3},16,["class"]))}}),Qe=x({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const e=o,s=D(()=>{const{class:a,...l}=e;return l});return(a,l)=>(m(),$(t(js),j({class:t(C)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e.class)},s.value),{default:i(()=>[P(a.$slots,"default")]),_:3},16,["class"]))}}),Xa=x({__name:"ToggleGroup",props:{rovingFocus:{type:Boolean},disabled:{type:Boolean},orientation:{},dir:{},loop:{type:Boolean},asChild:{type:Boolean},as:{},type:{},modelValue:{},defaultValue:{},class:{},variant:{},size:{}},emits:["update:modelValue"],setup(o,{emit:e}){const s=o,a=e;Tt("toggleGroup",{variant:s.variant,size:s.size});const l=D(()=>{const{class:f,...c}=s;return c}),d=W(l,a);return(f,c)=>(m(),$(t(Vs),j(t(d),{class:t(C)("flex items-center justify-center gap-1",s.class)}),{default:i(()=>[P(f.$slots,"default")]),_:3},16,["class"]))}}),Ka=nt("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),et=x({__name:"ToggleGroupItem",props:{value:{},defaultValue:{type:Boolean},pressed:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{},variant:{},size:{}},setup(o){const e=o,s=Lt("toggleGroup"),a=D(()=>{const{class:d,variant:f,size:c,...h}=e;return h}),l=X(a);return(d,f)=>{var c,h;return m(),$(t(Es),j(t(l),{class:t(C)(t(Ka)({variant:((c=t(s))==null?void 0:c.variant)||d.variant,size:((h=t(s))==null?void 0:h.size)||d.size}),e.class)}),{default:i(()=>[P(d.$slots,"default")]),_:3},16,["class"])}}}),Za={class:"absolute bottom-0 left-0 w-full h-full"},Ja={key:0,class:"w-full h-full"},Ga=["x","y","width","height"],Ya=["src","alt"],Qa=x({__name:"ThumbnailViewer",setup(o){const e=G(),{zoomRect:s}=Te(e),a=O(s.value),l=O(null),d=O(null),f=O(!0);st(s,()=>{c()}),at(()=>{c()});function c(){if(d.value&&l.value&&l.value.complete){let h=e.size.width/d.value.clientWidth,_=e.size.height/d.value.clientHeight;a.value={top:s.value.top/_,left:s.value.left/h,width:s.value.width/h,height:s.value.height/_},f.value=de(s.value.width,3)!=de(e.size.width,3)||de(s.value.height,3)!=de(e.size.height,3)}}return(h,_)=>(m(),B("div",{ref_key:"imageContainer",ref:d,class:"w-full h-auto border flex justify-center items-center relative"},[w("div",Za,[f.value?(m(),B("svg",Ja,[w("rect",{id:"box",x:a.value.left,y:a.value.top,width:a.value.width,height:a.value.height},null,8,Ga)])):ee("",!0)]),w("img",{class:"object-fit",ref_key:"base_image",ref:l,src:t(e).selectedImage.thumbnail||t(e).selectedImage.image,alt:t(e).selectedImage.name,"aspect-ratio":"auto",draggable:"false"},null,8,Ya)],512))}}),$e=(o,e)=>{const s=o.__vccOpts||o;for(const[a,l]of e)s[a]=l;return s},eo=$e(Qa,[["__scopeId","data-v-7bd1c9d6"]]),to={class:"flex flex-col pb-[12px] w-auto h-full"},so={class:"flex justify-center"},ao={class:"w-4/5"},oo={class:"flex-none space-y-4 py-4"},lo={class:"flex-none space-y-4 py-4"},no={class:"px-3 py-2"},ro={className:"mt-1.5 flex flex-row justify-between"},io={class:"w-5 text-center"},uo={class:"flex grow items-end mt-4"},co=x({__name:"Sidebar",setup(o){const e=G(),s=le();return(a,l)=>(m(),B("div",to,[w("div",so,[w("div",ao,[n(eo)])]),w("div",oo,[n(t(Xa),{type:"single","model-value":t(e).image,"onUpdate:modelValue":l[0]||(l[0]=d=>t(e).image=d.toString())},{default:i(()=>[n(t(et),{value:"stack"},{default:i(()=>l[3]||(l[3]=[I(" Stack ")])),_:1}),(m(!0),B(ae,null,oe(t(e).individualImages.keys(),d=>(m(),$(t(et),{value:d},{default:i(()=>[I(T(d),1)]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),w("div",lo,[w("div",no,[n(t(Wa),{"model-value":[t(e).index],max:t(e).stackImages.length-1,step:1,"onUpdate:modelValue":l[1]||(l[1]=d=>t(e).setIndex(d[0]))},null,8,["model-value","max"]),w("div",ro,[(m(!0),B(ae,null,oe(new Array(t(e).stackImages.length),d=>(m(),B("span",io," | "))),256))])]),n(t(qa),{"model-value":t(s).tab,"onUpdate:modelValue":l[2]||(l[2]=d=>t(s).tab=d.toString()),"default-value":"landmarks",class:"w-full my-4"},{default:i(()=>[n(t(Ua),{class:"grid w-full grid-cols-2"},{default:i(()=>[n(t(Ye),{value:"landmarks"},{default:i(()=>l[4]||(l[4]=[I(" Landmarks ")])),_:1}),n(t(Ye),{value:"distances"},{default:i(()=>l[5]||(l[5]=[I(" Distances ")])),_:1})]),_:1}),n(t(Qe),{value:"landmarks"},{default:i(()=>[n(t(_a))]),_:1}),n(t(Qe),{value:"distances"},{default:i(()=>[n(t(ka))]),_:1})]),_:1},8,["model-value"])]),w("div",uo,[n(t(ja))])]))}}),fo=x({__name:"ImageViewer",props:{class:{}},setup(o){const e=xe.get(Le.type),s=le(),a=G();s.$subscribe((r,u)=>{E()});const l=o,{selectedImage:d}=Te(a);st(d,()=>{E(),c.value.src=a.selectedImage.thumbnail||a.selectedImage.image,c.value.alt=a.selectedImage.thumbnail?"Thumbnail of "+a.selectedImage.name:a.selectedImage.name,a.selectedImage.thumbnail?c.value.onload=r=>K():c.value.onload=r=>{a.zoom<=0&&me(),E()}});const f=Ne("imageContainer"),c=O(new Image);a.selectedImage.thumbnail?c.value.onload=r=>K():c.value.onload=r=>{a.zoom<=0&&me(),E()},c.value.src=a.selectedImage.thumbnail||a.selectedImage.image,c.value.alt=a.selectedImage.thumbnail?"Thumbnail of "+a.selectedImage.name:a.selectedImage.name;const h=Ne("canvas");var _=new Image;const p=O({x:0,y:0}),g=O(!1),v=O(null),k=O({x:-1,y:-1}),M=r=>r*Math.PI/180;at(()=>{const r=new ResizeObserver(function(){f.value&&h.value&&c.value&&(h.value.width=Math.floor(f.value.clientWidth),h.value.height=Math.floor(f.value.clientHeight),E())});f.value&&r.observe(f.value)});function K(){console.log("load"),We(()=>{a.zoom<=0&&me();let r=a.selectedImage.name;setTimeout(()=>{r==a.selectedImage.name&&We(()=>{c.value.alt.endsWith(r)&&(_=new Image,_.src=a.selectedImage.image,_.alt=r,_.onload=u=>{console.log("fully loaded"),c.value.alt.endsWith(_.alt)&&(c.value=_,E())})})},500),E()})}function A(){if(h.value&&c.value&&c.value.complete&&a.zoom>0){let r=ge(),u=h.value.getContext("2d"),y=a.zoom/r.width,b=a.zoom/r.height,z=Ke/y;u.scale(y,b),u.translate(a.offset.x*r.width,a.offset.y*r.height),p.value={x:Math.max(0,(h.value.width-c.value.naturalWidth*y)/2)/y,y:Math.max(0,(h.value.height-c.value.naturalHeight*b)/2)/b},u.drawImage(c.value,0,0,c.value.naturalWidth,c.value.naturalHeight,p.value.x,p.value.y,c.value.naturalWidth,c.value.naturalHeight),s.distances.forEach(S=>{if(S.landmarks.length==0||!S.show)return;u.beginPath();let L=S.landmarks[0],Q=L.equals(v.value)?k.value:L.pose.marker,J={x:Q.x*r.width+p.value.x,y:Q.y*r.height+p.value.y};u.moveTo(J.x,J.y);for(let Ie=1;Ie<S.landmarks.length;Ie++)L=S.landmarks[Ie],Q=L.equals(v.value)?k.value:L.pose.marker,J={x:Q.x*r.width+p.value.x,y:Q.y*r.height+p.value.y},u.lineTo(J.x,J.y);u.strokeStyle=S.getColorHEX(),u.lineWidth=z/4,u.stroke(),u.closePath()}),s.landmarks.forEach(S=>{if(S.show)if(S.equals(v.value)){let L=k.value;L={x:L.x*r.width,y:L.y*r.height},ne(u,L,z)}else pe(u,S,z)}),s.distances.forEach(S=>{S.show&&S.landmarks.forEach((L,Q)=>{if(L.equals(v.value)){let J=k.value;J={x:J.x*r.width,y:J.y*r.height},ne(u,J,z)}else pe(u,L,z)})})}}function ne(r,u,y){const b=y*4;r.beginPath(),r.arc(u.x+p.value.x,u.y+p.value.y,b,0,2*Math.PI),r.strokeStyle="white",r.lineWidth=y/2,r.stroke(),r.closePath(),r.beginPath();let z=Z(u,45,b,p.value),S=Z(u,45,b*H,p.value);r.moveTo(z.x,z.y),r.lineTo(S.x,S.y),z=Z(u,135,b,p.value),S=Z(u,135,b*H,p.value),r.moveTo(z.x,z.y),r.lineTo(S.x,S.y),z=Z(u,225,b,p.value),S=Z(u,225,b*H,p.value),r.moveTo(z.x,z.y),r.lineTo(S.x,S.y),z=Z(u,315,b,p.value),S=Z(u,315,b*H,p.value),r.moveTo(z.x,z.y),r.lineTo(S.x,S.y),r.strokeStyle="white",r.lineWidth=y/3,r.stroke(),r.closePath(),r.beginPath(),r.moveTo(u.x+p.value.x+b*(1-H),u.y+p.value.y),r.lineTo(u.x+p.value.x+b*H,u.y+p.value.y),r.moveTo(u.x+p.value.x-b*(1-H),u.y+p.value.y),r.lineTo(u.x+p.value.x-b*H,u.y+p.value.y),r.moveTo(u.x+p.value.x,u.y+p.value.y+b*(1-H)),r.lineTo(u.x+p.value.x,u.y+p.value.y+b*H),r.moveTo(u.x+p.value.x,u.y+p.value.y-b*(1-H)),r.lineTo(u.x+p.value.x,u.y+p.value.y-b*H),r.strokeStyle="black",r.lineWidth=y/3,r.stroke(),r.closePath()}function pe(r,u,y){let b=ge(),z={x:u.getPose().marker.x*b.width,y:u.getPose().marker.y*b.height};r.beginPath(),r.arc(z.x+p.value.x,z.y+p.value.y,y,0,2*Math.PI),r.fillStyle=u.getColorHEX(),r.fill(),r.lineWidth=y/2,r.strokeStyle=u.getPose().image.name==a.selectedImage.name?"black":"white",r.stroke(),r.closePath()}function Z(r,u,y,b={x:0,y:0}){return{x:r.x+y*Math.cos(M(u))+b.x,y:r.y+y*Math.sin(M(u))+b.y}}function E(){if(h.value&&c.value&&c.value.complete){h.value.width=h.value.width,a.zoom<=0&&me(),Ce(0,0),A();const r=h.value.getBoundingClientRect();let u=he({x:r.left,y:r.top});u={x:Math.max(0,u.x),y:Math.max(0,u.y)};let y={x:Math.max(0,h.value.width-a.size.width*a.zoom)/a.zoom,y:Math.max(0,h.value.height-a.size.height*a.zoom)/a.zoom};a.zoomRect={top:u.y,left:u.x,width:h.value.width/a.zoom-y.x,height:h.value.height/a.zoom-y.y}}}function me(){f.value&&h.value&&(h.value.width=Math.floor(f.value.clientWidth),h.value.height=Math.floor(f.value.clientHeight),a.zoom=Math.min(f.value.clientWidth/a.size.width,f.value.clientHeight/a.size.height))}function ge(){return c.value&&c.value.complete?{width:c.value.naturalWidth/a.size.width,height:c.value.naturalHeight/a.size.height}:{width:0,height:0}}function he(r){let u=ge();const y=h.value.getBoundingClientRect();let b=(r.x-y.left)/a.zoom-a.offset.x-p.value.x/u.width,z=(r.y-y.top)/a.zoom-a.offset.y-p.value.y/u.height;return{x:b,y:z}}function Ce(r,u){h.value&&(a.offset.x=a.offset.x+r/a.zoom,a.offset.y=a.offset.y+u/a.zoom,a.offset.x=Math.min(0,Math.max(-(a.size.width*a.zoom-h.value.width)/a.zoom,a.offset.x)),a.offset.y=Math.min(0,Math.max(-(a.size.height*a.zoom-h.value.height)/a.zoom,a.offset.y)))}function yt(r){a.zoom=+(a.zoom*(1+r/20)).toFixed(2),a.zoom=Math.max(Ks,Math.min(Zs,a.zoom))}function bt(r){let u=a.zoom;yt(Math.sign(-r.deltaY));let y=a.zoom/u;const b=h.value.getBoundingClientRect();let z=r.pageX-b.left,S=r.pageY-b.top,L=-(b.width*y-b.width)*(z/b.width),Q=-(b.height*y-b.height)*(S/b.height);Ce(L,Q),E()}function wt(r){let u=he(r);if(a.image!="stack"){g.value=!0;return}if(r.button==0){g.value=!0;let y=Re(u);v.value=y,k.value=(y==null?void 0:y.pose.marker)??{x:-1,y:-1}}else if(r.button==2){let y={marker:u,image:a.selectedImage};if(!$t(u))return;let b=Re(u);if(b)Bt(b);else switch(s.tab){case"landmarks":It(y);break;case"distances":s.selectedDistance?Pt(y,s.selectedDistance):(Ct(y),s.selectedDistanceIndex=s.distances.length-1);break}E()}}function xt(r){g.value==!0&&(v.value==null?Ce(r.movementX,r.movementY):k.value=he({x:r.pageX,y:r.pageY}),E())}function Fe(r){if(g.value=!1,v.value!=null){let u=v.value;u.setPose(a.selectedImage,he({x:r.pageX,y:r.pageY})),e.computeLandmarkPosition(a.objectPath,u.pose).then(y=>{u.setPosition(y)}),Ae()}E()}function Ae(){v.value=null,k.value={x:-1,y:-1}}function Re(r){let u=null;return s.landmarks.forEach(y=>{y.show&&(u=He(r,y)||u)}),s.distances.forEach(y=>{y.show&&y.landmarks.forEach(b=>{u=He(r,b)||u})}),u}function He(r,u){let y=u.getPose();return y&&kt(r,y.marker,Ke/a.zoom)?u:null}function kt(r,u,y){return Math.sqrt((r.x-u.x)**2+(r.y-u.y)**2)<y}function $t(r){let u=ge();return c.value?r.x>=0&&r.y>=0&&r.x<=c.value.naturalWidth/u.width&&r.y<=c.value.naturalHeight/u.height:!1}async function Ct(r){let u=new we("Distance "+(s.distances.length+1)),y=s.distances.push(u)-1,b=await Pe(r,u.color);s.distances[y].landmarks.push(b)}async function Pe(r,u=void 0){let y=s.generateID(),b=await e.computeLandmarkPosition(a.objectPath,r);return new be(y,y,r,b,u)}async function Pt(r,u){u.landmarks.push(await Pe(r,u.color))}async function It(r){s.landmarks.push(await Pe(r))}function Bt(r){s.distances.forEach((u,y)=>{u.landmarks=u.landmarks.filter(b=>!b.equals(r))}),s.landmarks=s.landmarks.filter(u=>!u.equals(r)),E(),Ae()}return(r,u)=>(m(),B("div",{ref_key:"imageContainer",ref:f,class:F(t(C)("relative border w-full h-full flex justify-center items-center overflow-auto",l.class)),onWheel:u[1]||(u[1]=re(()=>{},["prevent"]))},[w("canvas",{ref_key:"canvas",ref:h,tabindex:"1",class:F({"cursor-none":v.value,"cursor-pointer":!v.value}),onMousedown:wt,onMouseup:Fe,onMousemove:xt,onMouseout:Fe,onWheel:bt,onContextmenu:u[0]||(u[0]=re(()=>{},["prevent"]))},null,34)],34))}}),po=$e(fo,[["__scopeId","data-v-9ad75b86"]]),mo={class:"w-full h-full border flex justify-center items-center"},go={key:0,class:"w-full h-full flex justify-center items-center"},ho={key:1,class:"w-full h-full flex justify-center items-center"},vo={class:"text-red-600"},_o={key:2,class:"w-full h-full flex flex-col items-center"},yo={class:"flex grow flex-row w-full justify-start"},bo=x({__name:"CameraViewer",setup(o){const e=G(),{isPending:s,isError:a,data:l,error:d}=Ts({queryKey:["all_images"],queryFn:()=>c()}),f=xe.get(Le.type);function c(){return f.getImages(e.objectPath).then(h=>(e.stackImages=h.stackImages.map(_=>({name:_[0],label:_[1],image:f.getFullImage(e.objectPath,_[0]),thumbnail:h.thumbnails?f.getThumbnail(e.objectPath,_[0]):""})),e.size=h.size,e.individualImages=new Map,h.individualImages.forEach((_,p)=>{e.individualImages.set(p,{name:_[0],label:_[1],image:f.getFullImage(e.objectPath,_[0]),thumbnail:h.thumbnails?f.getThumbnail(e.objectPath,_[0]):""})}),h))}return(h,_)=>(m(),B("div",mo,[t(s)?(m(),B("div",go,[n(t(Ls),{class:"animate-spin mr-10",width:"10%",height:"10%"})])):ee("",!0),t(a)?(m(),B("div",ho,[w("div",vo,T(t(d)),1)])):ee("",!0),t(l)?(m(),B("div",_o,[w("div",yo,[n(Y,{class:"border p-2"},{default:i(()=>[I(T(t(e).selectedImage.label)+" "+T(t(e).index+1)+"/"+T(t(e).stackImages.length),1)]),_:1})]),n(po,{class:"object-fit","aspect-ratio":"auto",draggable:"false"})])):ee("",!0)]))}}),wo=$e(bo,[["__scopeId","data-v-8d4a36db"]]),xo={class:"h-screen"},ko={class:"rest_height overflow-auto sidebar rounded-md border p-4"},$o={class:"rest_width rest_height flex grow items-center justify-center"},Co=x({__name:"ViewerView",setup(o){const e=ct(),s=G();let a=new URLSearchParams(window.location.search);return console.log(a.get("series")),s.setPath(a.get("series")),(l,d)=>(m(),B("main",xo,[n(ca,{class:"sticky menu top-0 flex flex-row grow z-50"}),n(t(ke)),w("div",{class:F(["h-full flex",t(e).isLeft?"flex-row":"flex-row-reverse"])},[w("div",ko,[n(t(co))]),w("div",$o,[n(t(wo))])],2)]))}}),Po=$e(Co,[["__scopeId","data-v-eb64c27d"]]),Io={class:"overflow-hidden"},Bo=x({__name:"App",setup(o){const e=G();function s(a){let l=a.key;l=="ArrowUp"&&e.increment(),l=="ArrowDown"&&e.decrement()}return(a,l)=>(m(),B("div",Io,[n(Po,{onKeydown:s})]))}}),_t=Os();_t.use(Fs);const Oe=Ot(Bo);Oe.use(_t);Oe.use(As);Oe.mount("#app");export{Lo as a,Eo as c,To as g};
